To learn how to use {\bfseries{{\itshape vt}}}, there are several resources that will help.


\begin{DoxyItemize}
\item Learn \mbox{\hyperlink{vt-build}{How to Build}}
\item Walk through the \mbox{\hyperlink{tutorial}{Tutorial}}
\item Read the small example programs
\begin{DoxyItemize}
\item Read the \mbox{\hyperlink{examples}{Examples}} walk-\/through
\item Examine {\ttfamily vt/examples/$\ast$}
\end{DoxyItemize}
\item Read about the different \mbox{\hyperlink{introduction_vt-components}{Components in vt}}
\item Messaging relies on serializing data with the {\itshape checkpoint} library. Learn \mbox{\hyperlink{ckpt_learn_serialize}{How to Serialize Data}} 
\end{DoxyItemize}\hypertarget{vt-build}{}\doxysection{How to Build}\label{vt-build}
Building D\+A\+R\+M\+A/vt with cmake

{\bfseries{{\itshape vt}}} can be built with {\ttfamily cmake} or built inside a {\ttfamily docker} container. Most of the external dependencies come bundled with {\bfseries{{\itshape vt}}} for ease of compiling.\hypertarget{vt-build_how-to-build}{}\doxysubsection{Building}\label{vt-build_how-to-build}
To build {\bfseries{{\itshape vt}}}, one must obtain the following dependencies\+:\hypertarget{vt-build_required-deps}{}\doxysubsubsection{Required}\label{vt-build_required-deps}

\begin{DoxyItemize}
\item checkpoint, ({\itshape vt} ecosystem)
\item M\+PI (mpich/openmpi/mvapich/\+I\+BM Spectrum M\+P\+I/\+Cray M\+P\+I\+C\+H/etc.)
\end{DoxyItemize}\hypertarget{vt-build_automatic-build-deps}{}\doxysubsubsection{Automatically build dependencies}\label{vt-build_automatic-build-deps}
Assuming M\+PI is installed and accessible via C\+C/\+C\+XX, the only other dependency that is required is checkpoint. The easiest way to get these built are to clone it inside {\ttfamily vt/lib}\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\$ git clone git@github.com:DARMA-\/tasking/vt}
\DoxyCodeLine{\$ cd vt/lib}
\DoxyCodeLine{\$ git clone git@github.com:DARMA-\/tasking/checkpoint}
\end{DoxyCode}


With these in {\ttfamily vt/lib}, cmake will automatically build them and stitch them into {\itshape vt}\textquotesingle{}s linking process.\hypertarget{vt-build_use-cmake-directly-vars}{}\doxysubsubsection{Using cmake directly}\label{vt-build_use-cmake-directly-vars}
One may use {\ttfamily cmake} as normal on {\itshape vt}, with checkpoint cloned in {\ttfamily vt/lib} to compile them all together as explained above. The following are some custom configuration build options that can be provided to {\ttfamily cmake} to change the build configuration\+:

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ C\+Make Variable  }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Default Value  }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Description   }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ C\+Make Variable  }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Default Value  }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Description   }\\\cline{1-3}
\endhead
{\ttfamily vt\+\_\+lb\+\_\+enabled}  &1  &Compile with support for runtime load balancing   \\\cline{1-3}
{\ttfamily vt\+\_\+trace\+\_\+enabled}  &0  &Compile with support for runtime tracing (Projections-\/format)   \\\cline{1-3}
{\ttfamily vt\+\_\+trace\+\_\+only}  &0  &Compile vt in trace-\/only mode (stripped down version for tracing M\+PI calls)   \\\cline{1-3}
{\ttfamily vt\+\_\+test\+\_\+trace\+\_\+runtime\+\_\+enabled}  &0  &Force tracing on at runtime for VT tests   \\\cline{1-3}
{\ttfamily vt\+\_\+doxygen\+\_\+enabled}  &0  &Enable doxygen generation   \\\cline{1-3}
{\ttfamily vt\+\_\+mimalloc\+\_\+enabled}  &0  &Enable {\ttfamily mimalloc}, alternative allocator for debugging memory usage/frees/corruption   \\\cline{1-3}
{\ttfamily vt\+\_\+asan\+\_\+enabled}  &0  &Enable building with address sanitizer   \\\cline{1-3}
{\ttfamily vt\+\_\+ubsan\+\_\+enabled}  &0  &Enable building with undefined behavior sanitizer   \\\cline{1-3}
{\ttfamily vt\+\_\+werror\+\_\+enabled}  &0  &Treat all warnings as errors   \\\cline{1-3}
{\ttfamily vt\+\_\+pool\+\_\+enabled}  &1  &Use memory pool in {\itshape vt} for message allocation   \\\cline{1-3}
{\ttfamily vt\+\_\+zoltan\+\_\+enabled}  &0  &Build with Zoltan enabled for {\ttfamily Zoltan\+LB} support   \\\cline{1-3}
{\ttfamily vt\+\_\+mpi\+\_\+guards}  &0  &Guards against mis-\/use of M\+PI calls in code using {\itshape vt}   \\\cline{1-3}
{\ttfamily vt\+\_\+priorities\+\_\+enabled}  &1  &Enable prioritization of work (adds bits in envelope)   \\\cline{1-3}
{\ttfamily vt\+\_\+diagnostics\+\_\+enabled}  &1  &Enable VT component diagnostics for performance analysis   \\\cline{1-3}
{\ttfamily vt\+\_\+diagnostics\+\_\+runtime\+\_\+enabled}  &0  &Enable VT component diagnostics at runtime by default   \\\cline{1-3}
{\ttfamily vt\+\_\+priority\+\_\+bits\+\_\+per\+\_\+level}  &3  &Number of bits per level of priority in envelope   \\\cline{1-3}
{\ttfamily vt\+\_\+build\+\_\+extended\+\_\+tests}  &1  &Build with full, extended testing   \\\cline{1-3}
{\ttfamily vt\+\_\+production\+\_\+build\+\_\+enabled}  &0  &Disable assertions and debug prints at compile time   \\\cline{1-3}
{\ttfamily vt\+\_\+unity\+\_\+build\+\_\+enabled}  &0  &Build with Unity/\+Jumbo mode enabled (requires C\+Make $>$= 3.\+16)   \\\cline{1-3}
{\ttfamily vt\+\_\+fcontext\+\_\+enabled}  &0  &Force use of fcontext for threading   \\\cline{1-3}
{\ttfamily vt\+\_\+tests\+\_\+num\+\_\+nodes}  &-\/  &Maximum number of nodes used for tests. If empty, then the default value detected by C\+Make is used   \\\cline{1-3}
{\ttfamily vt\+\_\+code\+\_\+coverage}  &0  &Enable code coverage for VT examples/tests   \\\cline{1-3}
{\ttfamily vt\+\_\+build\+\_\+tests}  &1  &Build all VT tests   \\\cline{1-3}
{\ttfamily vt\+\_\+build\+\_\+examples}  &1  &Build all VT examples   \\\cline{1-3}
{\ttfamily vt\+\_\+debug\+\_\+verbose}  &1 (not Release)  &Enable VT verbose debug prints at compile-\/time   \\\cline{1-3}
{\ttfamily vt\+\_\+no\+\_\+color\+\_\+enabled}  &0  &Set {\ttfamily -\/-\/vt\+\_\+no\+\_\+color} flag to true by default   \\\cline{1-3}
{\ttfamily B\+U\+I\+L\+D\+\_\+\+S\+H\+A\+R\+E\+D\+\_\+\+L\+I\+BS}  &0  &Build VT as shared library   \\\cline{1-3}
\end{longtabu}
\hypertarget{vt-build_using-the-build-script}{}\doxysubsubsection{Using the Build Script}\label{vt-build_using-the-build-script}
Instead of running {\ttfamily cmake}, one may invoke the {\ttfamily vt/ci/build\+\_\+cpp.\+sh} script which will run {\ttfamily cmake} for {\itshape vt} with environment variables for most configuration parameters.\hypertarget{vt-build_building-environment-variables}{}\doxyparagraph{Build Script Environment Variables}\label{vt-build_building-environment-variables}
\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Variable  }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Default Value  }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Description   }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Variable  }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Default Value  }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Description   }\\\cline{1-3}
\endhead
{\ttfamily C\+M\+A\+K\+E\+\_\+\+B\+U\+I\+L\+D\+\_\+\+T\+Y\+PE}  &Release  &The {\ttfamily cmake} build type   \\\cline{1-3}
{\ttfamily V\+T\+\_\+\+L\+B\+\_\+\+E\+N\+A\+B\+L\+ED}  &1  &Compile with support for runtime load balancing   \\\cline{1-3}
{\ttfamily V\+T\+\_\+\+T\+R\+A\+C\+E\+\_\+\+E\+N\+A\+B\+L\+ED}  &0  &Compile with support for runtime tracing (Projections-\/format)   \\\cline{1-3}
{\ttfamily V\+T\+\_\+\+T\+R\+A\+C\+E\+\_\+\+O\+N\+LY}  &0  &Compile vt in trace-\/only mode (stripped down version for tracing M\+PI calls)   \\\cline{1-3}
{\ttfamily V\+T\+\_\+\+T\+R\+A\+C\+E\+\_\+\+R\+U\+N\+T\+I\+M\+E\+\_\+\+E\+N\+A\+B\+L\+ED}  &0  &Force tracing on at runtime (used in CI for automatically testing tracing on all tests/examples)   \\\cline{1-3}
{\ttfamily V\+T\+\_\+\+D\+O\+X\+Y\+G\+E\+N\+\_\+\+E\+N\+A\+B\+L\+ED}  &0  &Enable doxygen generation   \\\cline{1-3}
{\ttfamily V\+T\+\_\+\+M\+I\+M\+A\+L\+L\+O\+C\+\_\+\+E\+N\+A\+B\+L\+ED}  &0  &Enable {\ttfamily mimalloc}, alternative allocator for debugging memory usage/frees/corruption   \\\cline{1-3}
{\ttfamily V\+T\+\_\+\+A\+S\+A\+N\+\_\+\+E\+N\+A\+B\+L\+ED}  &0  &Enable building with address sanitizer   \\\cline{1-3}
{\ttfamily V\+T\+\_\+\+U\+B\+S\+A\+N\+\_\+\+E\+N\+A\+B\+L\+ED}  &0  &Enable building with undefined behavior sanitizer   \\\cline{1-3}
{\ttfamily V\+T\+\_\+\+W\+E\+R\+R\+O\+R\+\_\+\+E\+N\+A\+B\+L\+ED}  &0  &Treat all warnings as errors   \\\cline{1-3}
{\ttfamily V\+T\+\_\+\+P\+O\+O\+L\+\_\+\+E\+N\+A\+B\+L\+ED}  &1  &Use memory pool in {\itshape vt} for message allocation   \\\cline{1-3}
{\ttfamily V\+T\+\_\+\+F\+C\+O\+N\+T\+E\+X\+T\+\_\+\+E\+N\+A\+B\+L\+ED}  &0  &Force use of fcontext for threading   \\\cline{1-3}
{\ttfamily V\+T\+\_\+\+Z\+O\+L\+T\+A\+N\+\_\+\+E\+N\+A\+B\+L\+ED}  &0  &Build with Zoltan enabled for {\ttfamily Zoltan\+LB} support   \\\cline{1-3}
{\ttfamily Z\+O\+L\+T\+A\+N\+\_\+\+D\+IR}  &$<$empty$>$  &Directory pointing to Zoltan installation   \\\cline{1-3}
{\ttfamily V\+T\+\_\+\+M\+P\+I\+\_\+\+G\+U\+A\+R\+D\+\_\+\+E\+N\+A\+B\+L\+ED}  &0  &Guards against mis-\/use of M\+PI calls in code using {\itshape vt}   \\\cline{1-3}
{\ttfamily V\+T\+\_\+\+E\+X\+T\+E\+N\+D\+E\+D\+\_\+\+T\+E\+S\+T\+S\+\_\+\+E\+N\+A\+B\+L\+ED}  &1  &Build with full, extended testing   \\\cline{1-3}
{\ttfamily V\+T\+\_\+\+U\+N\+I\+T\+Y\+\_\+\+B\+U\+I\+L\+D\+\_\+\+E\+N\+A\+B\+L\+ED}  &0  &Build with Unity/\+Jumbo mode enabled (requires C\+Make $>$= 3.\+16)   \\\cline{1-3}
{\ttfamily V\+T\+\_\+\+P\+R\+O\+D\+U\+C\+T\+I\+O\+N\+\_\+\+B\+U\+I\+L\+D\+\_\+\+E\+N\+A\+B\+L\+ED}  &0  &Disable assertions and debug prints at compile time   \\\cline{1-3}
{\ttfamily V\+T\+\_\+\+D\+I\+A\+G\+N\+O\+S\+T\+I\+C\+S\+\_\+\+E\+N\+A\+B\+L\+ED}  &1  &Enable VT component diagnostics for performance analysis   \\\cline{1-3}
{\ttfamily V\+T\+\_\+\+D\+I\+A\+G\+N\+O\+S\+T\+I\+C\+S\+\_\+\+R\+U\+N\+T\+I\+M\+E\+\_\+\+E\+N\+A\+B\+L\+ED}  &0  &Enable VT component diagnostics at runtime by default   \\\cline{1-3}
{\ttfamily V\+T\+\_\+\+D\+E\+B\+U\+G\+\_\+\+V\+E\+R\+B\+O\+SE}  &$<$empty$>$  &Enable VT verbose debug prints at compile-\/time   \\\cline{1-3}
{\ttfamily V\+T\+\_\+\+T\+E\+S\+T\+S\+\_\+\+N\+U\+M\+\_\+\+N\+O\+D\+ES}  &$<$empty$>$  &Maximum number of nodes used for tests. If empty, then the default value detected by C\+Make is used   \\\cline{1-3}
{\ttfamily V\+T\+\_\+\+N\+O\+\_\+\+C\+O\+L\+O\+R\+\_\+\+E\+N\+A\+B\+L\+ED}  &0  &Set {\ttfamily -\/-\/vt\+\_\+no\+\_\+color} flag to true by default   \\\cline{1-3}
{\ttfamily B\+U\+I\+L\+D\+\_\+\+S\+H\+A\+R\+E\+D\+\_\+\+L\+I\+BS}  &0  &Build VT as shared library   \\\cline{1-3}
\end{longtabu}


With these set, invoke the script with two arguments\+: the path to the {\itshape vt} root directory and the build path. Here\textquotesingle{}s an example assuming that {\itshape vt} is cloned into {\ttfamily /usr/src/vt} with trace enabled in debug mode.

{\bfseries{Usage for building\+:}}


\begin{DoxyCode}{0}
\DoxyCodeLine{\$ vt/ci/build\_cpp.sh <full-\/path-\/to-\/vt-\/source> <full-\/path-\/to-\/build-\/dir>}
\end{DoxyCode}


{\bfseries{Example\+:}}


\begin{DoxyCode}{0}
\DoxyCodeLine{\$ cd /usr/src}
\DoxyCodeLine{\$ git clone git@github.com:DARMA-\/tasking/vt}
\DoxyCodeLine{\$ VT\_TRACE\_ENABLED=1 CMAKE\_BUILD\_TYPE=Debug /usr/src/vt/ci/build\_cpp.sh /usr/src/vt /usr/build/vt}
\end{DoxyCode}
\hypertarget{vt-build_docker-build}{}\doxysubsubsection{Building with $<$tt$>$docker$<$/tt$>$ containerization}\label{vt-build_docker-build}
The easiest way to build {\itshape vt} is by using {\ttfamily docker} with the available containers that contain the proper compilers, M\+PI, and all other dependencies. First, install {\ttfamily docker} on the system. On some systems, {\ttfamily docker compose} might also need to be installed.

The {\ttfamily docker} builds are configured through {\ttfamily docker compose} to use a shared, cached filesystem mount with the host for {\ttfamily ccache} to enable fast re-\/builds.

For {\ttfamily docker compose}, the following variables can be set to configure the build. One may configure the architecture, compiler type (G\+NU, Clang, Intel, Nvidia) and compiler version, Linux distro (ubuntu or alpine), and distro version.

The default set of the docker configuration options is located in {\ttfamily vt/.env}, which {\ttfamily docker compose} will read.


\begin{DoxyCode}{0}
\DoxyCodeLine{\# Variables:}
\DoxyCodeLine{\#   ARCH=\{amd64, arm64v8, ...\}}
\DoxyCodeLine{\#   COMPILER\_TYPE=\{gnu, clang, intel, nvidia\}}
\DoxyCodeLine{\#   COMPILER=\{gcc-\/9, gcc-\/10,}
\DoxyCodeLine{\#             clang-\/8, clang-\/9, clang-\/10,}
\DoxyCodeLine{\#             icpc, icpx,}
\DoxyCodeLine{\#             nvcc-\/11, nvcc-\/11.2\}}
\DoxyCodeLine{\#   REPO=lifflander1/vt}
\DoxyCodeLine{\#   UBUNTU=\{18.04, 20.04, 22.04\}}
\DoxyCodeLine{\#   ULIMIT\_CORE=0}
\DoxyCodeLine{\#}
\DoxyCodeLine{\# DARMA/vt Configuration Variables:}
\DoxyCodeLine{\#   VT\_LB=1                   \# Enable load balancing}
\DoxyCodeLine{\#   VT\_TRACE=0                \# Enable tracing}
\DoxyCodeLine{\#   VT\_MIMALLOC=0             \# Enable mimalloc memory allocator}
\DoxyCodeLine{\#   VT\_DOCS=0                 \# Enable doxygen build}
\DoxyCodeLine{\#   VT\_TRACE\_RT=0             \# Enable tracing at runtime (for testing)}
\DoxyCodeLine{\#   VT\_ASAN=0                 \# Enable address sanitizer}
\DoxyCodeLine{\#   VT\_UBSAN=0                \# Enable undefined behavior sanitizer}
\DoxyCodeLine{\#   VT\_WERROR=1               \# Treat all warnings as errors}
\DoxyCodeLine{\#   VT\_EXTENDED\_TESTS=1       \# Build all the extended testing}
\DoxyCodeLine{\#   VT\_ZOLTAN=0               \# Build with Zoltan enabled}
\DoxyCodeLine{\#   VT\_UNITY\_BUILD=0          \# Build with Unity/Jumbo mode enabled}
\DoxyCodeLine{\#   VT\_FCONTEXT=0             \# Force use of fcontext for threading}
\DoxyCodeLine{\#   VT\_DIAGNOSTICS=1          \# Build with diagnostics enabled}
\DoxyCodeLine{\#   VT\_DIAGNOSTICS\_RUNTIME=0  \# Enable diagnostics at runtime by default}
\DoxyCodeLine{\#   BUILD\_TYPE=release        \# CMake build type}
\DoxyCodeLine{\#   VT\_CODE\_COVERAGE=0           \# Enable generation of code coverage reports}
\DoxyCodeLine{\#   VT\_DEBUG\_VERBOSE          \# Enable verbose debug prints at compile-\/time}
\DoxyCodeLine{\#   VT\_NO\_COLOR\_ENABLED=0     \# Set -\/-\/vt\_no\_color flag to true by default}
\DoxyCodeLine{\#   VT\_BUILD\_SHARED\_LIBS=0    \# Build VT as shared library}
\end{DoxyCode}


With these set, one may run the following for a non-\/interactive build with ubuntu. Or, to speed up the build process, the base container can be pulled for many of the common configurations\+: {\ttfamily docker compose pull ubuntu-\/cpp}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\$ cd vt}
\DoxyCodeLine{\$ docker compose run -\/e BUILD\_TYPE=debug -\/e VT\_TRACE=1 ubuntu-\/cpp}
\end{DoxyCode}


Or, alternatively, run a non-\/interactive build with alpine\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\$ cd vt}
\DoxyCodeLine{\$ docker compose run -\/e BUILD\_TYPE=debug -\/e VT\_TRACE=1 alpine-\/cpp}
\end{DoxyCode}


For an interactive build with ubuntu, where one can build, debug, and run {\ttfamily valgrind}, etc\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\$ cd vt}
\DoxyCodeLine{\$ docker compose run -\/e BUILD\_TYPE=debug -\/e VT\_TRACE=1 ubuntu-\/cpp-\/interactive}
\DoxyCodeLine{\# /vt/ci/build\_cpp.sh /vt /build}
\DoxyCodeLine{\# /vt/ci/test\_cpp.sh /vt /build}
\DoxyCodeLine{\# /vt/ci/build\_vt\_sample.sh /vt /build}
\end{DoxyCode}


The same call applies to alpine distro builds if you swap {\ttfamily ubuntu-\/cpp-\/interactive} for {\ttfamily alpine-\/cpp-\/interactive}.

For more detailed information on configuring the docker build, read the documentation in {\ttfamily vt/docker-\/compose.\+yml}.\hypertarget{vt-build_test-vt}{}\doxysubsection{Testing}\label{vt-build_test-vt}
After {\itshape vt} is built successfully, one may invoke the tests several ways. One may run {\ttfamily make test} or {\ttfamily ninja test} (depending on the generator used) or {\ttfamily ctest}, to run all the tests. Alternatively, the tests can be run automatically from the CI script\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\$ vt/ci/test\_cpp.sh <full-\/path-\/to-\/vt-\/source> <full-\/path-\/to-\/build-\/dir>}
\end{DoxyCode}
 \hypertarget{tutorial}{}\doxysection{Tutorial}\label{tutorial}
Tutorial of how to use {\bfseries{{\itshape vt}}}\hypertarget{tutorial_tutorial-init-finalize-vt}{}\doxysubsection{Initializing/\+Finalizing}\label{tutorial_tutorial-init-finalize-vt}
To initialize {\bfseries{{\itshape vt}}} all you must do is invoke the {\ttfamily \mbox{\hyperlink{namespacevt_a580ef23e9a224fc0907da1a6db308b5b}{vt\+::initialize}}} call with the program arguments, which creates and initializes a new {\bfseries{{\itshape vt}}} runtime. The initialize call reads the {\bfseries{{\itshape vt}}} arguments and removes them, leaving the remaining for the program.


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{int} main(\textcolor{keywordtype}{int} argc, \textcolor{keywordtype}{char}** argv) \{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a580ef23e9a224fc0907da1a6db308b5b}{vt::initialize}}(argc, argv);}
\DoxyCodeLine{   \textcolor{comment}{// program here}}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a540d90dbd6e97b69f1dcbc9ee9314cff}{vt::finalize}}();}
\DoxyCodeLine{\}}
\end{DoxyCode}


If you are already using M\+PI in your program already, you don\textquotesingle{}t want to call initialize like this because {\bfseries{{\itshape vt}}} will initialize M\+PI itself. Instead, you should pass a pointer to the live M\+PI communicator to {\bfseries{{\itshape vt}}} for it to clone, as so\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{int} main(\textcolor{keywordtype}{int} argc, \textcolor{keywordtype}{char}** argv) \{}
\DoxyCodeLine{  MPI\_Init(\&argc, \&argv);}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a580ef23e9a224fc0907da1a6db308b5b}{vt::initialize}}(argc, argv, \&MPI\_COMM\_WORLD);}
\DoxyCodeLine{   \textcolor{comment}{// program here}}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a540d90dbd6e97b69f1dcbc9ee9314cff}{vt::finalize}}();}
\DoxyCodeLine{  MPI\_Finalize();}
\DoxyCodeLine{\}}
\end{DoxyCode}


If, for any reason, you want to predefine configuration, you can do it by creating {\ttfamily App\+Config} object, setting its members as you wish, and passing it to {\ttfamily \mbox{\hyperlink{namespacevt_a580ef23e9a224fc0907da1a6db308b5b}{vt\+::initialize}}}\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{int} main(\textcolor{keywordtype}{int} argc, \textcolor{keywordtype}{char}** argv) \{}
\DoxyCodeLine{  arguments::AppConfig appConfig\{\};}
\DoxyCodeLine{  appConfig.vt\_lb\_name = \textcolor{stringliteral}{"RotateLB"};}
\DoxyCodeLine{  appConfig.vt\_lb\_data = \textcolor{keyword}{true};}
\DoxyCodeLine{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a580ef23e9a224fc0907da1a6db308b5b}{vt::initialize}}(argc, argv, \&appConfig);}
\DoxyCodeLine{   \textcolor{comment}{// program here}}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a540d90dbd6e97b69f1dcbc9ee9314cff}{vt::finalize}}();}
\DoxyCodeLine{\}}
\end{DoxyCode}


You can do also do it if you initialized M\+PI on your own\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{int} main(\textcolor{keywordtype}{int} argc, \textcolor{keywordtype}{char}** argv) \{}
\DoxyCodeLine{  MPI\_Init(\&argc, \&argv);}
\DoxyCodeLine{}
\DoxyCodeLine{  arguments::AppConfig appConfig\{\};}
\DoxyCodeLine{  appConfig.vt\_lb\_name = \textcolor{stringliteral}{"RotateLB"};}
\DoxyCodeLine{  appConfig.vt\_lb\_data = \textcolor{keyword}{true};}
\DoxyCodeLine{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a580ef23e9a224fc0907da1a6db308b5b}{vt::initialize}}(argc, argv, \&MPI\_COMM\_WORLD, \&appConfig);}
\DoxyCodeLine{   \textcolor{comment}{// program here}}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a540d90dbd6e97b69f1dcbc9ee9314cff}{vt::finalize}}();}
\DoxyCodeLine{  MPI\_Finalize();}
\DoxyCodeLine{\}}
\end{DoxyCode}


It is worth noting that if you run your application with any of vt\textquotesingle{}s command-\/line arguments and at the same time you define and pass {\ttfamily App\+Config} to {\ttfamily \mbox{\hyperlink{namespacevt_a580ef23e9a224fc0907da1a6db308b5b}{vt\+::initialize}}}, C\+LI arguments have a higher priority. In other words, if you predefine in source code and give from the command line the same vt\textquotesingle{}s argument, but with a different value, the program will use the C\+LI one.

There is also an option to use configuration file. Refer to C\+L\+I11 documentation for details \href{https://cliutils.github.io/CLI11/book/chapters/config.html}{\texttt{ https\+://cliutils.\+github.\+io/\+C\+L\+I11/book/chapters/config.\+html}}. Important thing to remember -\/ C\+L\+I11 processes configuration file before command line arguments, so in the end command line arguments might overwrite values defined in configuration file.\hypertarget{tutorial_tutorial-walkthrough}{}\doxysubsection{Tutorial Code Snippets}\label{tutorial_tutorial-walkthrough}
This page walks through the tutorial that exists in the source code. See {\ttfamily vt/tutorial/$\ast$.h} for the tutorial pieces in the repository. The main tutorial example code that stitches the pieces together is located in example\+: {\ttfamily vt/tutorial/tutorial\+\_\+main.\+h}. The actual code that compiles into an example is in {\ttfamily vt/examples/tutorial.\+cc}.


\begin{DoxyItemize}
\item Tutorial 1---Basic Concepts
\begin{DoxyItemize}
\item 1a\+: \mbox{\hyperlink{tutorial-1a}{Learning about context}}
\item 1b\+: \mbox{\hyperlink{tutorial-1b}{Learning about active handlers}}
\item 1c\+: \mbox{\hyperlink{tutorial-1c}{Learning about serialization}}
\item 1d\+: \mbox{\hyperlink{tutorial-1d}{Learning about broadcasts}}
\item 1e\+: \mbox{\hyperlink{tutorial-1e}{Learning about rooted groups}}
\item 1f\+: \mbox{\hyperlink{tutorial-1f}{Learning about collective groups}}
\item 1g\+: \mbox{\hyperlink{tutorial-1g}{Learning about callbacks}}
\item 1h\+: \mbox{\hyperlink{tutorial-1h}{Learning about reductions}}
\end{DoxyItemize}
\item Tutorial 2---Collections
\begin{DoxyItemize}
\item 2a\+: \mbox{\hyperlink{tutorial-2a}{Learning about collections}}
\item 2b\+: \mbox{\hyperlink{tutorial-2b}{Learning about collection reductions}}
\end{DoxyItemize}
\item Tutorial 3---Epochs
\begin{DoxyItemize}
\item 3a\+: \mbox{\hyperlink{tutorial-3a}{Learning about collective epochs}} 
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{tutorial-1a}{}\doxysubsection{Learning about context}\label{tutorial-1a}

\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacevt_1_1config_a6bd1d6215bda0d8ca02811798399f689a5dad3be974af03e75e234cb475c2cb20}{context}}() \{}
\DoxyCodeLine{  \textcolor{comment}{/*}}
\DoxyCodeLine{\textcolor{comment}{   *  ::vt::theContext() can be used to obtain the node and number of nodes:}}
\DoxyCodeLine{\textcolor{comment}{   *  these correlate exactly to the MPI ranks and MPI size.}}
\DoxyCodeLine{\textcolor{comment}{   *}}
\DoxyCodeLine{\textcolor{comment}{   *  By default if you initialize VT without passing an MPI communication, VT}}
\DoxyCodeLine{\textcolor{comment}{   *  will initialize MPI and use an internal communicator. If you want VT to}}
\DoxyCodeLine{\textcolor{comment}{   *  interoperate, you can pass a communicator to the initialize invocation.}}
\DoxyCodeLine{\textcolor{comment}{   *}}
\DoxyCodeLine{\textcolor{comment}{   */}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Equivalent to: MPI\_Comm\_rank(...)}}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} this\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Equivalent to: MPI\_Comm\_size(...)}}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} num\_nodes = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a7f41071aadf6d5fa9e1b6c703c5ff19d}{getNumNodes}}();}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// The header-\/only library fmt is used for printing throughout VT. You can use}}
\DoxyCodeLine{  \textcolor{comment}{// it because the headers are included by default}}
\DoxyCodeLine{  ::fmt::print(\textcolor{stringliteral}{"this\_node=\{\}, num\_nodes=\{\}\(\backslash\)n"}, this\_node, num\_nodes);}
\DoxyCodeLine{\}}
\end{DoxyCodeInclude}
\hypertarget{tutorial-1b}{}\doxysubsection{Learning about active handlers}\label{tutorial-1b}

\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{/*}}
\DoxyCodeLine{\textcolor{comment}{ * This is a user-\/defined message that can be sent to a node via VT's active}}
\DoxyCodeLine{\textcolor{comment}{ * message interface. A message in VT must be derived from the type}}
\DoxyCodeLine{\textcolor{comment}{ * vt::Message. The derived class will include the ``envelope'', which includes}}
\DoxyCodeLine{\textcolor{comment}{ * the handler, and other information for processing the message}}
\DoxyCodeLine{\textcolor{comment}{ */}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//            VT Base Message}}
\DoxyCodeLine{\textcolor{comment}{//           \(\backslash\)-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\//}}
\DoxyCodeLine{\textcolor{comment}{//            \(\backslash\)              /}}
\DoxyCodeLine{\textcolor{keyword}{struct }MyMsg : \mbox{\hyperlink{structvt_1_1messaging_1_1_active_msg}{::vt::Message}} \{}
\DoxyCodeLine{  \textcolor{comment}{// In general, a default constructor is required for the a message because it}}
\DoxyCodeLine{  \textcolor{comment}{// may be reconstructed by VT}}
\DoxyCodeLine{  MyMsg() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// A normal constructor}}
\DoxyCodeLine{  MyMsg(\textcolor{keywordtype}{int} in\_a, \textcolor{keywordtype}{int} in\_b) : a\_(in\_a), b\_(in\_b) \{ \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{int} getA()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} a\_; \}}
\DoxyCodeLine{  \textcolor{keywordtype}{int} getB()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} b\_; \}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{private}:}
\DoxyCodeLine{  \textcolor{keywordtype}{int} a\_ = 0, b\_ = 0;}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{/*}}
\DoxyCodeLine{\textcolor{comment}{ * Following are two active message handler declarations. These are the}}
\DoxyCodeLine{\textcolor{comment}{ * functions that can be remotely invoked by sending a message in VT. VT allows}}
\DoxyCodeLine{\textcolor{comment}{ * for multiple styles for handlers. The first (msgHandlerA) is the C-\/style}}
\DoxyCodeLine{\textcolor{comment}{ * active message handler. It is exactly equivalent (in terms of practical use}}
\DoxyCodeLine{\textcolor{comment}{ * ramifications) to the functor style, which follows (MsgHandlerB). Either}}
\DoxyCodeLine{\textcolor{comment}{ * style can be used to define a message handler. The only slight benefit the}}
\DoxyCodeLine{\textcolor{comment}{ * functor has is uniqueness in type, when enables introspection of the message}}
\DoxyCodeLine{\textcolor{comment}{ * type. This is realized in the sending side code: the function style requires}}
\DoxyCodeLine{\textcolor{comment}{ * the message type before the value function template parameter. However, both}}
\DoxyCodeLine{\textcolor{comment}{ * are *fully type checked* and will not allow the wrong message type to be}}
\DoxyCodeLine{\textcolor{comment}{ * sent.}}
\DoxyCodeLine{\textcolor{comment}{ */}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Forward declaration for the active message handler (function ptr style)}}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keywordtype}{void} msgHandlerA(MyMsg* msg);}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Forward declaration for the active message handler (functor style)}}
\DoxyCodeLine{\textcolor{keyword}{struct }MsgHandlerB \{}
\DoxyCodeLine{  \textcolor{keywordtype}{void} operator()(MyMsg* msg);}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} activeMessageNode() \{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} this\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} num\_nodes = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a7f41071aadf6d5fa9e1b6c703c5ff19d}{getNumNodes}}();}
\DoxyCodeLine{  (void)num\_nodes;  \textcolor{comment}{// don't warn about unused variable}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{/*}}
\DoxyCodeLine{\textcolor{comment}{   * A basic active message send essentially does an}}
\DoxyCodeLine{\textcolor{comment}{   * ``MPI\_Send(..,destination,...)'' to the destination node passed to}}
\DoxyCodeLine{\textcolor{comment}{   * ::vt::theMsg()-\/>sendMsg(destination). The handler, which is passed as the}}
\DoxyCodeLine{\textcolor{comment}{   * second template argument, is the function that is triggered when the}}
\DoxyCodeLine{\textcolor{comment}{   * message arrives on the destination node.}}
\DoxyCodeLine{\textcolor{comment}{   *}}
\DoxyCodeLine{\textcolor{comment}{   * The theMsg()-\/>sendMsg(..) does not serialize the message sent to the}}
\DoxyCodeLine{\textcolor{comment}{   * destination node. Even if the message has a serialize method (the above}}
\DoxyCodeLine{\textcolor{comment}{   * example does not), it is sent as bytes. This is because sendMsg always just}}
\DoxyCodeLine{\textcolor{comment}{   * sends the data directly that is passed to it.}}
\DoxyCodeLine{\textcolor{comment}{   *}}
\DoxyCodeLine{\textcolor{comment}{   * This example uses the function pointer style compared to the send inside of}}
\DoxyCodeLine{\textcolor{comment}{   * msgHandlerA, which uses the functor style send.}}
\DoxyCodeLine{\textcolor{comment}{   */}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordflow}{if} (this\_node == 0) \{}
\DoxyCodeLine{    \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} to\_node = 1;}
\DoxyCodeLine{    \textcolor{keyword}{auto} msg = ::vt::makeMessage<MyMsg>(29,32);}
\DoxyCodeLine{    \mbox{\hyperlink{namespacevt_aeafd31f866aeb4dc6fc2f6ee97136350}{::vt::theMsg}}()-\/>\mbox{\hyperlink{group__preregister_ga0162a39473e7f9b490a79a7983d949ac}{sendMsg}}<msgHandlerA>(to\_node, msg);}
\DoxyCodeLine{  \}}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keywordtype}{void} msgHandlerA(MyMsg* msg) \{}
\DoxyCodeLine{  \textcolor{comment}{/*}}
\DoxyCodeLine{\textcolor{comment}{   * VT provides vtAssert (and a half-\/dozen variants) that replace the simple}}
\DoxyCodeLine{\textcolor{comment}{   * the assert call found in cassert.}}
\DoxyCodeLine{\textcolor{comment}{   */}}
\DoxyCodeLine{  \mbox{\hyperlink{config__assert_8h_aeddd4990a496e91a0ca5d6c16437359b}{vtAssert}}(msg-\/>getA() == 29, \textcolor{stringliteral}{"Value a incorrect"});}
\DoxyCodeLine{  \mbox{\hyperlink{config__assert_8h_aeddd4990a496e91a0ca5d6c16437359b}{vtAssert}}(msg-\/>getB() == 32, \textcolor{stringliteral}{"Value b incorrect"});}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keyword}{auto} \textcolor{keyword}{const} cur\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{}
\DoxyCodeLine{  ::fmt::print(\textcolor{stringliteral}{"msgHandlerA: triggered on node=\{\}\(\backslash\)n"}, cur\_node);}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{/* Node 0 sends MyMsg to node 1 in the above code so this should execute on}}
\DoxyCodeLine{\textcolor{comment}{   * node 1 */}}
\DoxyCodeLine{  \mbox{\hyperlink{config__assert_8h_aeddd4990a496e91a0ca5d6c16437359b}{vtAssert}}(cur\_node == 1, \textcolor{stringliteral}{"This handler should execute on node 1"});}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{/*}}
\DoxyCodeLine{\textcolor{comment}{   * In response to this message, node 1 sends a message back to node 0. This}}
\DoxyCodeLine{\textcolor{comment}{   * invocation uses the functor style send.}}
\DoxyCodeLine{\textcolor{comment}{   *}}
\DoxyCodeLine{\textcolor{comment}{   * -\/-\/ Message Ownsership -\/-\/}}
\DoxyCodeLine{\textcolor{comment}{   * When an API that 'sends a message' is called, ownership is relinquished.}}
\DoxyCodeLine{\textcolor{comment}{   *}}
\DoxyCodeLine{\textcolor{comment}{   * The loss of ownership is the same as using std::move and the MsgPtr object}}
\DoxyCodeLine{\textcolor{comment}{   * supplied becomes invalid for later use. This use includes attempting}}
\DoxyCodeLine{\textcolor{comment}{   * to send the same message twice. std::move can be used explicit if desired.}}
\DoxyCodeLine{\textcolor{comment}{   *}}
\DoxyCodeLine{\textcolor{comment}{   * A vtAssert will be raised if such an invalid use is detected.}}
\DoxyCodeLine{\textcolor{comment}{   */}}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} to\_node = 0;}
\DoxyCodeLine{  \textcolor{keyword}{auto} msg2 = ::vt::makeMessage<MyMsg>(10,20);}
\DoxyCodeLine{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_aeafd31f866aeb4dc6fc2f6ee97136350}{::vt::theMsg}}()-\/>\mbox{\hyperlink{group__preregister_ga0162a39473e7f9b490a79a7983d949ac}{sendMsg}}<MsgHandlerB>(to\_node, msg2);}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Alternate/equivalent form with explicit (and optional) std::move:}}
\DoxyCodeLine{  \textcolor{comment}{//}}
\DoxyCodeLine{  \textcolor{comment}{//   ::vt::theMsg()-\/>sendMsg<MsgHandlerB, MyMsg>(to\_node, std::move(msg2));}}
\DoxyCodeLine{  \textcolor{comment}{//}}
\DoxyCodeLine{  \textcolor{comment}{// In both cases it is invalid to attempt to use msg2 here as the ownership}}
\DoxyCodeLine{  \textcolor{comment}{// of the message has been relinquished/lost when making the call.}}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{void} MsgHandlerB::operator()(MyMsg* msg) \{}
\DoxyCodeLine{  \textcolor{keyword}{auto} \textcolor{keyword}{const} cur\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{  \mbox{\hyperlink{config__assert_8h_aeddd4990a496e91a0ca5d6c16437359b}{vtAssert}}(msg-\/>getA() == 10, \textcolor{stringliteral}{"Value a incorrect"});}
\DoxyCodeLine{  \mbox{\hyperlink{config__assert_8h_aeddd4990a496e91a0ca5d6c16437359b}{vtAssert}}(msg-\/>getB() == 20, \textcolor{stringliteral}{"Value b incorrect"});}
\DoxyCodeLine{  \mbox{\hyperlink{config__assert_8h_aeddd4990a496e91a0ca5d6c16437359b}{vtAssert}}(cur\_node == 0, \textcolor{stringliteral}{"This handler should execute on node 0"});}
\DoxyCodeLine{  ::fmt::print(\textcolor{stringliteral}{"msgHandlerB: triggered on node=\{\}\(\backslash\)n"}, cur\_node);}
\DoxyCodeLine{\}}
\end{DoxyCodeInclude}
\hypertarget{tutorial-1c}{}\doxysubsection{Learning about serialization}\label{tutorial-1c}

\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{/*}}
\DoxyCodeLine{\textcolor{comment}{ * Some user defined data structures}}
\DoxyCodeLine{\textcolor{comment}{ */}}
\DoxyCodeLine{\textcolor{keyword}{struct }Particle \{}
\DoxyCodeLine{  Particle() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{  Particle(\textcolor{keywordtype}{double} in\_x, \textcolor{keywordtype}{double} in\_y, \textcolor{keywordtype}{double} in\_z)}
\DoxyCodeLine{    : x(in\_x), y(in\_y), z(in\_z)}
\DoxyCodeLine{  \{ \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Non-\/message types can use serializers like this.}}
\DoxyCodeLine{  \textcolor{keyword}{template} <\textcolor{keyword}{typename} SerializerT>}
\DoxyCodeLine{  \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacecheckpoint_a075da4e7344cf037943362517e606c3a}{serialize}}(SerializerT\& s) \{}
\DoxyCodeLine{    s | x | y | z;}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{double} x, y, z;}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{struct }Data \{}
\DoxyCodeLine{  \textcolor{keywordtype}{int} a;}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keyword}{template} <\textcolor{keyword}{typename} SerializerT>}
\DoxyCodeLine{  \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacecheckpoint_a075da4e7344cf037943362517e606c3a}{serialize}}(SerializerT\& s) \{}
\DoxyCodeLine{    s | a;}
\DoxyCodeLine{  \}}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// TODO -\/ show data with non-\/intrusive serialization}}
\DoxyCodeLine{\textcolor{comment}{// TODO -\/ show data that does not need serialization}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//                  VT Base Message}}
\DoxyCodeLine{\textcolor{comment}{//                 \(\backslash\)-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\//}}
\DoxyCodeLine{\textcolor{comment}{//                  \(\backslash\)              /}}
\DoxyCodeLine{\textcolor{keyword}{struct }ParticleMsg : \mbox{\hyperlink{structvt_1_1messaging_1_1_active_msg}{::vt::Message}} \{}
\DoxyCodeLine{  \textcolor{keyword}{using} MessageParentType = \mbox{\hyperlink{namespacevt_a3a3ddfef40b4c90915fa43cdd5f129ea}{::vt::Message}}; \textcolor{comment}{// base message}}
\DoxyCodeLine{  \mbox{\hyperlink{message__serialize_8h_a54128d5338aaa9c918179826085e13d1}{vt\_msg\_serialize\_required}}();         \textcolor{comment}{// mark serialization mode}}
\DoxyCodeLine{}
\DoxyCodeLine{  ParticleMsg() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{}
\DoxyCodeLine{  ParticleMsg(\textcolor{keywordtype}{int} in\_x, \textcolor{keywordtype}{int} in\_y, \textcolor{keywordtype}{int} in\_z)}
\DoxyCodeLine{    : x(in\_x), y(in\_y), z(in\_z)}
\DoxyCodeLine{  \{ \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{/*}}
\DoxyCodeLine{\textcolor{comment}{   * Implement a serialize method so the std::vector and pointer are properly}}
\DoxyCodeLine{\textcolor{comment}{   * serialization on the send.}}
\DoxyCodeLine{\textcolor{comment}{   */}}
\DoxyCodeLine{  \textcolor{keyword}{template} <\textcolor{keyword}{typename} SerializerT>}
\DoxyCodeLine{  \textcolor{keywordtype}{void} \mbox{\hyperlink{structvt_1_1messaging_1_1_active_msg_a758f02bef5991c48d6c9a56c30ca7ad9}{serialize}}(SerializerT\& s) \{}
\DoxyCodeLine{    \mbox{\hyperlink{namespacecheckpoint_a075da4e7344cf037943362517e606c3a}{MessageParentType::serialize}}(s);    \textcolor{comment}{// ensure parent is serialized consistently}}
\DoxyCodeLine{}
\DoxyCodeLine{    s | particles;}
\DoxyCodeLine{    s | x | y | z;}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{// Serialize a pointer by first serializing whether it is non-\/null and then}}
\DoxyCodeLine{    \textcolor{comment}{// the actual value if it's not non-\/null}}
\DoxyCodeLine{    \textcolor{keywordtype}{bool} has\_a = a != \textcolor{keyword}{nullptr};}
\DoxyCodeLine{    s | has\_a;}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (has\_a) \{}
\DoxyCodeLine{      s | *a;}
\DoxyCodeLine{    \}}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{public}:}
\DoxyCodeLine{  std::vector<Particle> particles;}
\DoxyCodeLine{  \textcolor{keywordtype}{int} x = 0, y = 0, z = 0;}
\DoxyCodeLine{  Data* a = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Forward declaration for the active message handler}}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keywordtype}{void} msgSerialA(ParticleMsg* msg);}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Tutorial code to demonstrate serialization in active message sends}}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} activeMessageSerialization() \{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} this\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} num\_nodes = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a7f41071aadf6d5fa9e1b6c703c5ff19d}{getNumNodes}}();}
\DoxyCodeLine{  (void)num\_nodes;  \textcolor{comment}{// don't warn about unused variable}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{/*}}
\DoxyCodeLine{\textcolor{comment}{   * The theMsg()-\/>sendMsg(..) will serialize the message sent to the}}
\DoxyCodeLine{\textcolor{comment}{   * destination node if it has a serialize method. If not, it will send the}}
\DoxyCodeLine{\textcolor{comment}{   * message as if it is sent directly the sendMsg.}}
\DoxyCodeLine{\textcolor{comment}{   */}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordflow}{if} (this\_node == 0) \{}
\DoxyCodeLine{    \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} to\_node = 1;}
\DoxyCodeLine{    \textcolor{keyword}{auto} msg = ::vt::makeMessage<ParticleMsg>(1,2,3);}
\DoxyCodeLine{    msg-\/>particles.push\_back(Particle\{10,11,12\});}
\DoxyCodeLine{    msg-\/>particles.push\_back(Particle\{13,14,15\});}
\DoxyCodeLine{    \mbox{\hyperlink{namespacevt_aeafd31f866aeb4dc6fc2f6ee97136350}{::vt::theMsg}}()-\/>\mbox{\hyperlink{group__preregister_ga0162a39473e7f9b490a79a7983d949ac}{sendMsg}}<msgSerialA>(to\_node, msg);}
\DoxyCodeLine{  \}}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Message handler}}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keywordtype}{void} msgSerialA(ParticleMsg* msg) \{}
\DoxyCodeLine{  \mbox{\hyperlink{config__assert_8h_aeddd4990a496e91a0ca5d6c16437359b}{vtAssert}}(msg-\/>particles.size() == 2, \textcolor{stringliteral}{"Should be two particles"});}
\DoxyCodeLine{  \mbox{\hyperlink{config__assert_8h_aeddd4990a496e91a0ca5d6c16437359b}{vtAssert}}(msg-\/>x == 1 \&\& msg-\/>y == 2 \&\& msg-\/>z == 3, \textcolor{stringliteral}{"Values x,y,z incorrect"});}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keyword}{auto} \textcolor{keyword}{const} cur\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{/* Node 0 sends MyMsg to node 1 in the above code so this should execute on}}
\DoxyCodeLine{\textcolor{comment}{   * node 1 */}}
\DoxyCodeLine{  \mbox{\hyperlink{config__assert_8h_aeddd4990a496e91a0ca5d6c16437359b}{vtAssert}}(cur\_node == 1, \textcolor{stringliteral}{"This handler should execute on node 1"});}
\DoxyCodeLine{}
\DoxyCodeLine{  ::fmt::print(\textcolor{stringliteral}{"msgSerialA: triggered on node=\{\}\(\backslash\)n"}, cur\_node);}
\DoxyCodeLine{\}}
\end{DoxyCodeInclude}
\hypertarget{tutorial-1d}{}\doxysubsection{Learning about broadcasts}\label{tutorial-1d}

\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//                  VT Base Message}}
\DoxyCodeLine{\textcolor{comment}{//                 \(\backslash\)-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\//}}
\DoxyCodeLine{\textcolor{comment}{//                  \(\backslash\)              /}}
\DoxyCodeLine{\textcolor{keyword}{struct }MyDataMsg : \mbox{\hyperlink{structvt_1_1messaging_1_1_active_msg}{::vt::Message}} \{}
\DoxyCodeLine{  MyDataMsg() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{  MyDataMsg(\textcolor{keywordtype}{double} in\_x, \textcolor{keywordtype}{double} in\_y, \textcolor{keywordtype}{double} in\_z)}
\DoxyCodeLine{    : x(in\_x), y(in\_y), z(in\_z)}
\DoxyCodeLine{  \{ \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{double} getX()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} x; \}}
\DoxyCodeLine{  \textcolor{keywordtype}{double} getY()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} y; \}}
\DoxyCodeLine{  \textcolor{keywordtype}{double} getZ()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} z; \}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{private}:}
\DoxyCodeLine{  \textcolor{keywordtype}{double} x = 0.0, y = 0.0, z = 0.0;}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Forward declaration for the active message handler}}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keywordtype}{void} msgHandlerX(MyDataMsg* msg);}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Tutorial code to demonstrate broadcasting a message to the entire system}}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} activeMessageBroadcast() \{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} this\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} num\_nodes = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a7f41071aadf6d5fa9e1b6c703c5ff19d}{getNumNodes}}();}
\DoxyCodeLine{  (void)num\_nodes;  \textcolor{comment}{// don't warn about unused variable}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{/*}}
\DoxyCodeLine{\textcolor{comment}{   * default\_proxy.broadcast(..) will send the message to every node in the}}
\DoxyCodeLine{\textcolor{comment}{   * system. Every node will include all the nodes that VT has depending on the}}
\DoxyCodeLine{\textcolor{comment}{   * MPI communicator passed in or the size attained (number of ranks) when}}
\DoxyCodeLine{\textcolor{comment}{   * executing MPI init directly in non-\/interoperability mode.}}
\DoxyCodeLine{\textcolor{comment}{   *}}
\DoxyCodeLine{\textcolor{comment}{   * -\/-\/ Message Ownership -\/-\/}}
\DoxyCodeLine{\textcolor{comment}{   * default\_proxy.broadcast(..) will create message out of args passed}}
\DoxyCodeLine{\textcolor{comment}{   * into it. There's an alternative -\/ default\_proxy.broadcastMsg(..) -\/ which}}
\DoxyCodeLine{\textcolor{comment}{   * relinquishes ownership of the message passed to:}}
\DoxyCodeLine{\textcolor{comment}{   *}}
\DoxyCodeLine{\textcolor{comment}{   *   auto msg = ::vt::makeMessage<MyDataMsg>(1.0, 2.0, 3.0);}}
\DoxyCodeLine{\textcolor{comment}{   *   auto const default\_proxy = theObjGroup()-\/>getDefault();}}
\DoxyCodeLine{\textcolor{comment}{   *   default\_proxy.broadcastMsg<MyDataMsg, msgHandlerX>(msg);}}
\DoxyCodeLine{\textcolor{comment}{   *}}
\DoxyCodeLine{\textcolor{comment}{   *  Most calls to VT that supply a message are expected to relinquish ownership.}}
\DoxyCodeLine{\textcolor{comment}{   */}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordflow}{if} (this\_node == 0) \{}
\DoxyCodeLine{    \textcolor{keyword}{auto} \textcolor{keyword}{const} default\_proxy = \mbox{\hyperlink{namespacevt_a833f0115b692f578167cbd88e30d39c5}{theObjGroup}}()-\/>\mbox{\hyperlink{structvt_1_1objgroup_1_1_obj_group_manager_a4447b8f4881710bc7b0b7a37de9d10b9}{getDefault}}();}
\DoxyCodeLine{    default\_proxy.\mbox{\hyperlink{structvt_1_1objgroup_1_1proxy_1_1_proxy_3_01void_01_4_a13f8d6751a246a449e7d13ae7eed3541}{broadcast}}<MyDataMsg, msgHandlerX>(1.0, 2.0, 3.0);}
\DoxyCodeLine{  \}}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Message handler}}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keywordtype}{void} msgHandlerX(MyDataMsg* msg) \{}
\DoxyCodeLine{  \mbox{\hyperlink{config__assert_8h_aeddd4990a496e91a0ca5d6c16437359b}{vtAssert}}(}
\DoxyCodeLine{    msg-\/>getX() == 1.0 \&\& msg-\/>getY() == 2.0 \&\& msg-\/>getZ() == 3.0,}
\DoxyCodeLine{    \textcolor{stringliteral}{"Values x,y,z incorrect"}}
\DoxyCodeLine{  );}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keyword}{auto} \textcolor{keyword}{const} cur\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{  ::fmt::print(\textcolor{stringliteral}{"msgHandlerX: triggered on node=\{\}\(\backslash\)n"}, cur\_node);}
\DoxyCodeLine{\}}
\end{DoxyCodeInclude}
\hypertarget{tutorial-1e}{}\doxysubsection{Learning about rooted groups}\label{tutorial-1e}

\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//                  VT Base Message}}
\DoxyCodeLine{\textcolor{comment}{//                 \(\backslash\)-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\//}}
\DoxyCodeLine{\textcolor{comment}{//                  \(\backslash\)              /}}
\DoxyCodeLine{\textcolor{keyword}{struct }MySimpleMsg : \mbox{\hyperlink{structvt_1_1messaging_1_1_active_msg}{::vt::Message}} \{ \};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Forward declaration for the active message handler}}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keywordtype}{void} msgHandlerGroupA(MySimpleMsg* msg);}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Tutorial code to demonstrate rooted group creation and broadcast to that group}}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} activeMessageGroupRoot() \{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} this\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} num\_nodes = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a7f41071aadf6d5fa9e1b6c703c5ff19d}{getNumNodes}}();}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{/*}}
\DoxyCodeLine{\textcolor{comment}{   * This is an example of the rooted group creation and broadcast to that}}
\DoxyCodeLine{\textcolor{comment}{   * group. A group allows the user to create a subset of nodes. A broadcast by}}
\DoxyCodeLine{\textcolor{comment}{   * default sends the message to every node in the default group (which}}
\DoxyCodeLine{\textcolor{comment}{   * includes all nodes). If a explicit group is set in the envelope, the}}
\DoxyCodeLine{\textcolor{comment}{   * broadcast will only arrive on the nodes in that group.}}
\DoxyCodeLine{\textcolor{comment}{   */}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordflow}{if} (this\_node == 0) \{}
\DoxyCodeLine{    \textcolor{comment}{// Create range for the group [1,num\_nodes);}}
\DoxyCodeLine{    \textcolor{keyword}{auto} range = std::make\_unique<::vt::group::region::Range>(1, num\_nodes);}
\DoxyCodeLine{    \textcolor{comment}{// The non-\/collective group is created by a single node based on a range or}}
\DoxyCodeLine{    \textcolor{comment}{// list of nodes. The lambda is executed once the group is created. By}}
\DoxyCodeLine{    \textcolor{comment}{// setting the group in the envelope of the message and broadcasting the}}
\DoxyCodeLine{    \textcolor{comment}{// message will arrive on the set of nodes included in the group}}
\DoxyCodeLine{    \textcolor{keyword}{auto} \textcolor{keywordtype}{id} = \mbox{\hyperlink{namespacevt_a4548473dce44fb654400009e2b2fe64e}{theGroup}}()-\/>\mbox{\hyperlink{structvt_1_1group_1_1_group_manager_a076330445139abce77e1f6ab6e4358c5}{newGroup}}(std::move(range), [](\mbox{\hyperlink{namespacevt_a27b5e4411c9b6140c49100e050e2f743}{GroupType}} group\_id)\{}
\DoxyCodeLine{      fmt::print(\textcolor{stringliteral}{"Group is created: id=\{:x\}\(\backslash\)n"}, group\_id);}
\DoxyCodeLine{      \textcolor{keyword}{auto} msg = makeMessage<MySimpleMsg>();}
\DoxyCodeLine{      \mbox{\hyperlink{namespacevt_a9f9d4ce6034c0eaaf98bdffd33d0e1c7}{envelopeSetGroup}}(msg-\/>env, group\_id);}
\DoxyCodeLine{      \mbox{\hyperlink{namespacevt_aeafd31f866aeb4dc6fc2f6ee97136350}{theMsg}}()-\/>\mbox{\hyperlink{group__typesafehan_ga1a347aac6b6b8d47c9b1c8cc11b7f33e}{broadcastMsg}}<msgHandlerGroupA>(msg);}
\DoxyCodeLine{    \});}
\DoxyCodeLine{    \textcolor{comment}{// The `id' that is returned from the newGroup invocation, can be used}}
\DoxyCodeLine{    \textcolor{comment}{// anywhere in the system to broadcast (multicast) to this group.}}
\DoxyCodeLine{    (void)\textcolor{keywordtype}{id};  \textcolor{comment}{// don't warn about unused variable}}
\DoxyCodeLine{  \}}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Message handler}}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keywordtype}{void} msgHandlerGroupA([[maybe\_unused]] MySimpleMsg* msg) \{}
\DoxyCodeLine{  \textcolor{keyword}{auto} \textcolor{keyword}{const} cur\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{  \mbox{\hyperlink{config__assert_8h_aeddd4990a496e91a0ca5d6c16437359b}{vtAssert}}(cur\_node >= 1, \textcolor{stringliteral}{"This handler should only execute on nodes >= 1"});}
\DoxyCodeLine{}
\DoxyCodeLine{  ::fmt::print(\textcolor{stringliteral}{"msgHandlerGroupA: triggered on node=\{\}\(\backslash\)n"}, cur\_node);}
\DoxyCodeLine{\}}
\end{DoxyCodeInclude}
\hypertarget{tutorial-1f}{}\doxysubsection{Learning about collective groups}\label{tutorial-1f}

\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//                  VT Base Message}}
\DoxyCodeLine{\textcolor{comment}{//                 \(\backslash\)-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\//}}
\DoxyCodeLine{\textcolor{comment}{//                  \(\backslash\)              /}}
\DoxyCodeLine{\textcolor{keyword}{struct }MySimpleMsg2 : \mbox{\hyperlink{structvt_1_1messaging_1_1_active_msg}{::vt::Message}} \{ \};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Forward declaration for the active message handler}}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keywordtype}{void} msgHandlerGroupB(MySimpleMsg2* msg);}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Tutorial code to demonstrate collective group creation and broadcast to that group}}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} activeMessageGroupCollective() \{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} this\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} num\_nodes = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a7f41071aadf6d5fa9e1b6c703c5ff19d}{getNumNodes}}();}
\DoxyCodeLine{  (void)num\_nodes;  \textcolor{comment}{// don't warn about unused variable}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{/*}}
\DoxyCodeLine{\textcolor{comment}{   * This is an example of the collective group creation and broadcast to that}}
\DoxyCodeLine{\textcolor{comment}{   * group. A group allows the user to create a subset of nodes. The collective}}
\DoxyCodeLine{\textcolor{comment}{   * group allows all nodes to participate in creating the group by passing a}}
\DoxyCodeLine{\textcolor{comment}{   * boolean that indicates if they are apart of the group.}}
\DoxyCodeLine{\textcolor{comment}{   *}}
\DoxyCodeLine{\textcolor{comment}{   * Unlike the rooted group creation (which requires an initial set at a root}}
\DoxyCodeLine{\textcolor{comment}{   * node), the collective group is fully distributed: its creation and}}
\DoxyCodeLine{\textcolor{comment}{   * storage. The set of all nodes included is never stored in a central}}
\DoxyCodeLine{\textcolor{comment}{   * location. This is managed by efficient distributed algorithms that create a}}
\DoxyCodeLine{\textcolor{comment}{   * spanning tree based on the filter and rebalance it depending on outcomes.}}
\DoxyCodeLine{\textcolor{comment}{   */}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keyword}{auto} \textcolor{keyword}{const}\& is\_even\_node = this\_node \% 2 == 0;}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keyword}{auto} \mbox{\hyperlink{namespacevt_1_1config_a6bd1d6215bda0d8ca02811798399f689a132506d2b8e888d0a91ae4470d4197c1}{group}} = \mbox{\hyperlink{namespacevt_a4548473dce44fb654400009e2b2fe64e}{theGroup}}()-\/>\mbox{\hyperlink{structvt_1_1group_1_1_group_manager_a92b301d6cf77af7d57ed822c6f044d58}{newGroupCollective}}(}
\DoxyCodeLine{    is\_even\_node, [](\mbox{\hyperlink{namespacevt_a27b5e4411c9b6140c49100e050e2f743}{GroupType}} group\_id)\{}
\DoxyCodeLine{      fmt::print(\textcolor{stringliteral}{"Group is created: id=\{:x\}\(\backslash\)n"}, group\_id);}
\DoxyCodeLine{}
\DoxyCodeLine{      \textcolor{comment}{// In this example, node 1 broadcasts to the group of even nodes}}
\DoxyCodeLine{      \textcolor{keyword}{auto} \textcolor{keyword}{const} my\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{      \textcolor{keywordflow}{if} (my\_node == 1) \{}
\DoxyCodeLine{        \textcolor{keyword}{auto} msg = makeMessage<MySimpleMsg2>();}
\DoxyCodeLine{        \mbox{\hyperlink{namespacevt_a9f9d4ce6034c0eaaf98bdffd33d0e1c7}{envelopeSetGroup}}(msg-\/>env, group\_id);}
\DoxyCodeLine{        \mbox{\hyperlink{namespacevt_aeafd31f866aeb4dc6fc2f6ee97136350}{theMsg}}()-\/>\mbox{\hyperlink{group__typesafehan_ga1a347aac6b6b8d47c9b1c8cc11b7f33e}{broadcastMsg}}<msgHandlerGroupB>(msg);}
\DoxyCodeLine{      \}}
\DoxyCodeLine{    \}}
\DoxyCodeLine{  );}
\DoxyCodeLine{  (void)\mbox{\hyperlink{namespacevt_1_1config_a6bd1d6215bda0d8ca02811798399f689a132506d2b8e888d0a91ae4470d4197c1}{group}};  \textcolor{comment}{// don't warn about unused variable}}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Message handler}}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keywordtype}{void} msgHandlerGroupB([[maybe\_unused]] MySimpleMsg2* msg) \{}
\DoxyCodeLine{  \textcolor{keyword}{auto} \textcolor{keyword}{const} cur\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{  \mbox{\hyperlink{config__assert_8h_aeddd4990a496e91a0ca5d6c16437359b}{vtAssert}}(cur\_node \% 2 == 0, \textcolor{stringliteral}{"This handler should only execute on even nodes"});}
\DoxyCodeLine{}
\DoxyCodeLine{  ::fmt::print(\textcolor{stringliteral}{"msgHandlerGroupB: triggered on node=\{\}\(\backslash\)n"}, cur\_node);}
\DoxyCodeLine{\}}
\end{DoxyCodeInclude}
\hypertarget{tutorial-1g}{}\doxysubsection{Learning about callbacks}\label{tutorial-1g}

\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Forward declaration for the active message handler}}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keywordtype}{void} getCallbackHandler(Callback<int> cb);}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// An active message handler used as the target for a callback}}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keywordtype}{void} callbackHandler(\textcolor{keywordtype}{int} data) \{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} cur\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{  ::fmt::print(\textcolor{stringliteral}{"\{\}: triggering active message callback: \{\}\(\backslash\)n"}, cur\_node, data);}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// An active message handler used as the target for a callback}}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keywordtype}{void} callbackBcastHandler(\textcolor{keywordtype}{int} data) \{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} cur\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{  ::fmt::print(}
\DoxyCodeLine{    \textcolor{stringliteral}{"\{\}: triggering active message callback bcast: \{\}\(\backslash\)n"}, cur\_node, data}
\DoxyCodeLine{  );}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Tutorial code to demonstrate using a callback}}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} activeMessageCallback() \{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} this\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} num\_nodes = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a7f41071aadf6d5fa9e1b6c703c5ff19d}{getNumNodes}}();}
\DoxyCodeLine{  (void)num\_nodes;  \textcolor{comment}{// don't warn about unused variable}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{/*}}
\DoxyCodeLine{\textcolor{comment}{   * Callbacks allow one to generalize the notion of an endpoint with a abstract}}
\DoxyCodeLine{\textcolor{comment}{   * interface the callee can use without changing code. A callback can trigger}}
\DoxyCodeLine{\textcolor{comment}{   * a lambda, handler on a node, handler broadcast, handler/lambda with a}}
\DoxyCodeLine{\textcolor{comment}{   * context, message send of virtual context collection (element or broadcast)}}
\DoxyCodeLine{\textcolor{comment}{   */}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordflow}{if} (this\_node == 0) \{}
\DoxyCodeLine{    \textcolor{comment}{// Node sending the callback message to, which shall invoke the callback}}
\DoxyCodeLine{    \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} to\_node = 1;}
\DoxyCodeLine{    \textcolor{comment}{// Node that we want to callback to execute on}}
\DoxyCodeLine{    \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} cb\_node = 0;}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{// Example of active message handler callback with send node}}
\DoxyCodeLine{    \{}
\DoxyCodeLine{      \textcolor{keyword}{auto} cb = \mbox{\hyperlink{namespacevt_a673b109e94c7bca58313504c83e1da94}{::vt::theCB}}()-\/>\mbox{\hyperlink{structvt_1_1pipe_1_1_pipe_manager_a3c6313a04c8ba283f4c32986ff8c7c30}{makeSend}}<callbackHandler>(cb\_node);}
\DoxyCodeLine{      \mbox{\hyperlink{namespacevt_aeafd31f866aeb4dc6fc2f6ee97136350}{::vt::theMsg}}()-\/>\mbox{\hyperlink{group__typesafehan_ga4557b5ce74c8c5df0013cf49738517bf}{send}}<getCallbackHandler>(\mbox{\hyperlink{namespacevt_a04777c732e1a2b2c317995af9972b999}{Node}}\{to\_node\}, cb);}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{// Example of active message handler callback with broadcast}}
\DoxyCodeLine{    \{}
\DoxyCodeLine{      \textcolor{keyword}{auto} cb = \mbox{\hyperlink{namespacevt_a673b109e94c7bca58313504c83e1da94}{::vt::theCB}}()-\/>\mbox{\hyperlink{structvt_1_1pipe_1_1_pipe_manager_a5b124c9c765e8b3bb9aca1b367e45db2}{makeBcast}}<callbackBcastHandler>();}
\DoxyCodeLine{      \mbox{\hyperlink{namespacevt_aeafd31f866aeb4dc6fc2f6ee97136350}{::vt::theMsg}}()-\/>\mbox{\hyperlink{group__typesafehan_ga4557b5ce74c8c5df0013cf49738517bf}{send}}<getCallbackHandler>(\mbox{\hyperlink{namespacevt_a04777c732e1a2b2c317995af9972b999}{Node}}\{to\_node\}, cb);}
\DoxyCodeLine{    \}}
\DoxyCodeLine{  \}}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Message handler for to receive callback and invoke it}}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keywordtype}{void} getCallbackHandler(Callback<int> cb) \{}
\DoxyCodeLine{  \textcolor{keyword}{auto} \textcolor{keyword}{const} cur\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{  ::fmt::print(\textcolor{stringliteral}{"getCallbackHandler: triggered on node=\{\}\(\backslash\)n"}, cur\_node);}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Send the callback a message}}
\DoxyCodeLine{  cb.send(29 + cur\_node);}
\DoxyCodeLine{\}}
\end{DoxyCodeInclude}
\hypertarget{tutorial-1h}{}\doxysubsection{Learning about reductions}\label{tutorial-1h}

\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{keywordtype}{void} reduceResult(\textcolor{keywordtype}{int} result) \{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} num\_nodes = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a7f41071aadf6d5fa9e1b6c703c5ff19d}{getNumNodes}}();}
\DoxyCodeLine{  (void)num\_nodes;  \textcolor{comment}{// don't warn about possibly unused variable}}
\DoxyCodeLine{  fmt::print(\textcolor{stringliteral}{"reduction value=\{\}\(\backslash\)n"}, result);}
\DoxyCodeLine{  assert(num\_nodes * 50 == result);}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Tutorial code to demonstrate using reduction on all nodes}}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} activeMessageReduce() \{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} this\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{  (void)this\_node;  \textcolor{comment}{// don't warn about unused variable}}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} num\_nodes = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a7f41071aadf6d5fa9e1b6c703c5ff19d}{getNumNodes}}();}
\DoxyCodeLine{  (void)num\_nodes;  \textcolor{comment}{// don't warn about unused variable}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{/*}}
\DoxyCodeLine{\textcolor{comment}{   * Perform reduction over all the nodes.}}
\DoxyCodeLine{\textcolor{comment}{   */}}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} root\_reduce\_node = 0;}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keyword}{auto} r = \mbox{\hyperlink{namespacevt_aa8e0c0ab253e7ad1acd5d09e36fea769}{vt::theCollective}}()-\/>\mbox{\hyperlink{structvt_1_1collective_1_1reduce_1_1_reduce_manager_afa3c814ff0e1c7ef1a9f76ed4036512b}{global}}();}
\DoxyCodeLine{  r-\/>\mbox{\hyperlink{structvt_1_1collective_1_1reduce_1_1_reduce_adf8bd9748a220a3ed29087c30f8adafc}{reduce}}<reduceResult, \mbox{\hyperlink{namespacevt_1_1collective_a7a695a8e6ed8247f643918113b7bf881}{collective::PlusOp}}>(\mbox{\hyperlink{structvt_1_1util_1_1strong_1_1detail_1_1_strong}{vt::Node}}\{root\_reduce\_node\}, 50);}
\DoxyCodeLine{\}}
\end{DoxyCodeInclude}
\hypertarget{tutorial-2a}{}\doxysubsection{Learning about collections}\label{tutorial-2a}

\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{// Forward declaration for message}}
\DoxyCodeLine{\textcolor{keyword}{struct }MyCollMsg;}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//               VT Base Class for a collection}}
\DoxyCodeLine{\textcolor{comment}{//         \(\backslash\)-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\//}}
\DoxyCodeLine{\textcolor{comment}{//          \(\backslash\)                                   /}}
\DoxyCodeLine{\textcolor{comment}{//           \(\backslash\)                         Index   /}}
\DoxyCodeLine{\textcolor{comment}{//            \(\backslash\)                     \(\backslash\)-\/-\/-\/-\/-\/-\/-\/-\/-\//}}
\DoxyCodeLine{\textcolor{comment}{//             \(\backslash\)                     \(\backslash\)       /}}
\DoxyCodeLine{\textcolor{keyword}{struct }MyCol : \mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_collection}{::vt::Collection}}<MyCol,Index1D> \{}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{void} msgHandler(MyCollMsg* msg);}
\DoxyCodeLine{}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//                 VT Base Message for Collections}}
\DoxyCodeLine{\textcolor{comment}{//               \(\backslash\)-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\//}}
\DoxyCodeLine{\textcolor{comment}{//                \(\backslash\)                              /}}
\DoxyCodeLine{\textcolor{keyword}{struct }MyCollMsg : \mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_collection_message}{::vt::CollectionMessage}}<MyCol> \{ \};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{void} MyCol::msgHandler([[maybe\_unused]] MyCollMsg* msg) \{}
\DoxyCodeLine{  \textcolor{keyword}{auto} cur\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{  \textcolor{keyword}{auto} idx = this-\/>\mbox{\hyperlink{namespacecheckpoint_1_1dispatch_1_1typeregistry_aa75ef84e9b63a687784360ded2d56fe4}{getIndex}}();}
\DoxyCodeLine{  ::fmt::print(\textcolor{stringliteral}{"MyCol::msgHandler index=\{\}, node=\{\}\(\backslash\)n"}, idx.x(), cur\_node);}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Tutorial code to demonstrate creating a collection}}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} collection() \{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} this\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} num\_nodes = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a7f41071aadf6d5fa9e1b6c703c5ff19d}{getNumNodes}}();}
\DoxyCodeLine{  (void)num\_nodes;  \textcolor{comment}{// don't warn about unused variable}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{/*}}
\DoxyCodeLine{\textcolor{comment}{   * This is an example of creating a virtual context collection with an index}}
\DoxyCodeLine{\textcolor{comment}{   * range}}
\DoxyCodeLine{\textcolor{comment}{   */}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Range of 32 elements for the collection}}
\DoxyCodeLine{  \textcolor{keyword}{auto} range = \mbox{\hyperlink{namespacevt_a5540efc78234273e1796fb003fe4d234}{vt::Index1D}}(32);}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Construct the collection (collective variant): invoked by all nodes. By}}
\DoxyCodeLine{  \textcolor{comment}{// default, the elements will be block mapped to the nodes}}
\DoxyCodeLine{  \textcolor{keyword}{auto} proxy = vt::makeCollection<MyCol>(\textcolor{stringliteral}{"tutorial\_collection"})}
\DoxyCodeLine{    .bounds(range)    \textcolor{comment}{// Set the bounds for the collection}}
\DoxyCodeLine{    .bulkInsert()     \textcolor{comment}{// Bulk insert all the elements within the bounds}}
\DoxyCodeLine{    .wait();          \textcolor{comment}{// Wait for construction and get the proxy back}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordflow}{if} (this\_node == 0) \{}
\DoxyCodeLine{    \textcolor{comment}{// Broadcast a message to the entire collection. The msgHandler will be}}
\DoxyCodeLine{    \textcolor{comment}{// invoked on every element to the collection}}
\DoxyCodeLine{    proxy.\mbox{\hyperlink{structvt_1_1objgroup_1_1proxy_1_1_proxy_a0b716ca776b1f06e0d7d45afbe9e5274}{broadcast}}<MyCollMsg,\&MyCol::msgHandler>();}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{// Send a message to the 5th element of the collection}}
\DoxyCodeLine{    proxy[5].send<MyCollMsg,\&MyCol::msgHandler>();}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Collectively broadcast to the collection (all nodes participate for a}}
\DoxyCodeLine{  \textcolor{comment}{// single broadcast)}}
\DoxyCodeLine{  proxy.broadcastCollective<MyCollMsg,\&MyCol::msgHandler>();}
\DoxyCodeLine{\}}
\end{DoxyCodeInclude}
\hypertarget{tutorial-2b}{}\doxysubsection{Learning about collection reductions}\label{tutorial-2b}

\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{// Forward declaration for message}}
\DoxyCodeLine{\textcolor{keyword}{struct }ColRedMsg;}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//                  VT Base Class for a collection}}
\DoxyCodeLine{\textcolor{comment}{//            \(\backslash\)-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\//}}
\DoxyCodeLine{\textcolor{comment}{//             \(\backslash\)                                        /}}
\DoxyCodeLine{\textcolor{comment}{//              \(\backslash\)                              Index   /}}
\DoxyCodeLine{\textcolor{comment}{//               \(\backslash\)                          \(\backslash\)-\/-\/-\/-\/-\/-\/-\/-\/-\//}}
\DoxyCodeLine{\textcolor{comment}{//                \(\backslash\)                          \(\backslash\)       /}}
\DoxyCodeLine{\textcolor{keyword}{struct }ReduceCol : \mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_collection}{::vt::Collection}}<ReduceCol,Index1D> \{}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{void} reduceHandler();}
\DoxyCodeLine{  \textcolor{keywordtype}{void} reduceTarget(\textcolor{keywordtype}{int} value);}
\DoxyCodeLine{}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//                  VT Base Message for Collections}}
\DoxyCodeLine{\textcolor{comment}{//               \(\backslash\)-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\//}}
\DoxyCodeLine{\textcolor{comment}{//                \(\backslash\)                                 /}}
\DoxyCodeLine{\textcolor{keyword}{struct }ColRedMsg : \mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_collection_message}{::vt::CollectionMessage}}<ReduceCol> \{ \};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{void} ReduceCol::reduceHandler() \{}
\DoxyCodeLine{  \textcolor{keyword}{auto} cur\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{  (void)cur\_node;  \textcolor{comment}{// don't warn about unused variable}}
\DoxyCodeLine{  \textcolor{keyword}{auto} idx = this-\/>\mbox{\hyperlink{namespacecheckpoint_1_1dispatch_1_1typeregistry_aa75ef84e9b63a687784360ded2d56fe4}{getIndex}}();}
\DoxyCodeLine{  (void)idx;  \textcolor{comment}{// don't warn about unused variable}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{//::fmt::print("MyCol::reduceHandler index=\{\}, node=\{\}\(\backslash\)n", idx.x(), cur\_node);}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keyword}{auto} proxy = getCollectionProxy();}
\DoxyCodeLine{  \textcolor{keywordtype}{int} val = 100;}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Invoke the reduce!}}
\DoxyCodeLine{  proxy.\mbox{\hyperlink{structvt_1_1objgroup_1_1proxy_1_1_proxy_ab8d4b9337c19d4ff0e758d03f3941b98}{allreduce}}<\&ReduceCol::reduceTarget, \mbox{\hyperlink{namespacevt_1_1collective_a7a695a8e6ed8247f643918113b7bf881}{collective::PlusOp}}>(val);}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{int} number\_of\_elements = 32;}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{void} ReduceCol::reduceTarget(\textcolor{keywordtype}{int} value) \{}
\DoxyCodeLine{  fmt::print(\textcolor{stringliteral}{"collection reduce value=\{\}\(\backslash\)n"}, value);}
\DoxyCodeLine{  assert(number\_of\_elements * 100 == value);}
\DoxyCodeLine{}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Tutorial code to demonstrate reducing a collection}}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} collectionReduce() \{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} this\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} num\_nodes = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a7f41071aadf6d5fa9e1b6c703c5ff19d}{getNumNodes}}();}
\DoxyCodeLine{  (void)num\_nodes;  \textcolor{comment}{// don't warn about unused variable}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{/*}}
\DoxyCodeLine{\textcolor{comment}{   * This is an example of reducing over a virtual context collection}}
\DoxyCodeLine{\textcolor{comment}{   */}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordflow}{if} (this\_node == 0) \{}
\DoxyCodeLine{    \textcolor{comment}{// Range of `number\_of\_elements` elements for the collection}}
\DoxyCodeLine{    \textcolor{keyword}{auto} range = \mbox{\hyperlink{namespacevt_a5540efc78234273e1796fb003fe4d234}{vt::Index1D}}(number\_of\_elements);}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{// Construct the collection in a rooted manner. By default, the elements}}
\DoxyCodeLine{    \textcolor{comment}{// will be block mapped to the nodes}}
\DoxyCodeLine{    \textcolor{keyword}{auto} proxy = vt::makeCollectionRooted<ReduceCol>(\textcolor{stringliteral}{"tutorial\_collection\_reduce"})}
\DoxyCodeLine{      .bounds(range)     \textcolor{comment}{// Set the bounds for the collection}}
\DoxyCodeLine{      .bulkInsert()      \textcolor{comment}{// Bulk insert all the elements within the bounds}}
\DoxyCodeLine{      .wait();           \textcolor{comment}{// Wait for construction and get the proxy back}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{// Broadcast a message to the entire collection. The reduceHandler will be}}
\DoxyCodeLine{    \textcolor{comment}{// invoked on every element to the collection}}
\DoxyCodeLine{    proxy.\mbox{\hyperlink{structvt_1_1objgroup_1_1proxy_1_1_proxy_a0b716ca776b1f06e0d7d45afbe9e5274}{broadcast}}<\&ReduceCol::reduceHandler>();}
\DoxyCodeLine{  \}}
\DoxyCodeLine{\}}
\end{DoxyCodeInclude}
\hypertarget{tutorial-3a}{}\doxysubsection{Learning about collective epochs}\label{tutorial-3a}

\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//              VT Base Message}}
\DoxyCodeLine{\textcolor{comment}{//             \(\backslash\)-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\//}}
\DoxyCodeLine{\textcolor{comment}{//              \(\backslash\)              /}}
\DoxyCodeLine{\textcolor{keyword}{struct }ExampleMsg : \mbox{\hyperlink{structvt_1_1messaging_1_1_active_msg}{::vt::Message}} \{}
\DoxyCodeLine{  ExampleMsg() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{  \textcolor{keyword}{explicit} ExampleMsg(int32\_t in\_ttl) : ttl(in\_ttl-\/1) \{ \}}
\DoxyCodeLine{}
\DoxyCodeLine{  int32\_t ttl = 0;}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Forward declaration for the active message handler}}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keywordtype}{void} recurHandler(ExampleMsg* msg);}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Tutorial code to demonstrate using a callback}}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} activeMessageTerm() \{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} this\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} num\_nodes = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a7f41071aadf6d5fa9e1b6c703c5ff19d}{getNumNodes}}();}
\DoxyCodeLine{  (void)num\_nodes;  \textcolor{comment}{// don't warn about unused variable}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{/*}}
\DoxyCodeLine{\textcolor{comment}{   * Termination will allow us to track a subcomputation with causality to}}
\DoxyCodeLine{\textcolor{comment}{   * determine when a sub-\/computation terminated in a distributed-\/manner. The}}
\DoxyCodeLine{\textcolor{comment}{   * tutorial demonstrates how to use `collective` epochs. Rooted epoch will be}}
\DoxyCodeLine{\textcolor{comment}{   * demonstrated in a follow-\/on tutorial.}}
\DoxyCodeLine{\textcolor{comment}{   */}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Create a new epoch: this is a collective invocation}}
\DoxyCodeLine{  \textcolor{keyword}{auto} \textcolor{keyword}{const} new\_epoch = \mbox{\hyperlink{namespacevt_a127580fdfcaba0b4171e5c48c5676733}{theTerm}}()-\/>\mbox{\hyperlink{structvt_1_1term_1_1_termination_detector_aeba62165ec8dfbc445e3631ff295f159}{makeEpochCollective}}();}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordflow}{if} (this\_node == 0) \{}
\DoxyCodeLine{    \textcolor{keyword}{auto} msg = vt::makeMessage<ExampleMsg>(8);}
\DoxyCodeLine{    \mbox{\hyperlink{namespacevt_a4a0a9928690206b588dbcac2afb71088}{envelopeSetEpoch}}(msg-\/>env, new\_epoch);}
\DoxyCodeLine{    \mbox{\hyperlink{namespacevt_aeafd31f866aeb4dc6fc2f6ee97136350}{vt::theMsg}}()-\/>\mbox{\hyperlink{group__preregister_ga0162a39473e7f9b490a79a7983d949ac}{sendMsg}}<recurHandler>(this\_node+1, msg);}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Any node that wishes to have a notification on termination for a given}}
\DoxyCodeLine{  \textcolor{comment}{// epoch can add actions for the termination detector}}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a127580fdfcaba0b4171e5c48c5676733}{theTerm}}()-\/>\mbox{\hyperlink{structvt_1_1term_1_1_term_action_a1227042cb4eb38937fb8ed34bcbdf998}{addAction}}(}
\DoxyCodeLine{    new\_epoch, []\{}
\DoxyCodeLine{      \textcolor{keyword}{auto} \textcolor{keyword}{const} \mbox{\hyperlink{namespacevt_1_1config_a46e57c33bee1b9f1fa95455af86d80e0a576033c81e2ddd03d721ecef3b1b3f81}{node}} = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{      fmt::print(\textcolor{stringliteral}{"\{\}: recurHandler terminated\(\backslash\)n"}, \mbox{\hyperlink{namespacevt_1_1config_a46e57c33bee1b9f1fa95455af86d80e0a576033c81e2ddd03d721ecef3b1b3f81}{node}});}
\DoxyCodeLine{    \}}
\DoxyCodeLine{  );}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// This is not explicitly a collective, but all nodes need to call}}
\DoxyCodeLine{  \textcolor{comment}{// `finishedEpoch` to tell the system they are finished sending messages}}
\DoxyCodeLine{  \textcolor{comment}{// for the epoch.}}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a127580fdfcaba0b4171e5c48c5676733}{theTerm}}()-\/>\mbox{\hyperlink{structvt_1_1term_1_1_termination_detector_ad54d75c50bd3f34f30247817737bc303}{finishedEpoch}}(new\_epoch);}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Message handler that recursively sends messages}}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keywordtype}{void} recurHandler(ExampleMsg* msg) \{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} num\_nodes = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a7f41071aadf6d5fa9e1b6c703c5ff19d}{getNumNodes}}();}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{NodeType}} \textcolor{keyword}{const} this\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{::vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{}
\DoxyCodeLine{  ::fmt::print(}
\DoxyCodeLine{    \textcolor{stringliteral}{"\{\}: recurHandler: ttl=\{\}, triggered\(\backslash\)n"}, this\_node, msg-\/>ttl}
\DoxyCodeLine{  );}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordflow}{if} (msg-\/>ttl > 0) \{}
\DoxyCodeLine{    \textcolor{keyword}{auto} \textcolor{keyword}{const} num\_send = static\_cast<int32\_t>(drand48() * 3);}
\DoxyCodeLine{    \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} i = 0; i < num\_send; i++) \{}
\DoxyCodeLine{      \textcolor{keyword}{auto} next\_node = (this\_node + 1 > num\_nodes -\/ 1) ? 0 : (this\_node + 1);}
\DoxyCodeLine{}
\DoxyCodeLine{      ::fmt::print(}
\DoxyCodeLine{        \textcolor{stringliteral}{"\{\}: recurHandler: i=\{\}, next\_node=\{\}, num\_send=\{\}\(\backslash\)n"},}
\DoxyCodeLine{        this\_node, i, next\_node, num\_send}
\DoxyCodeLine{      );}
\DoxyCodeLine{}
\DoxyCodeLine{      \textcolor{keyword}{auto} msg\_send = vt::makeMessage<ExampleMsg>(msg-\/>ttl);}
\DoxyCodeLine{      \mbox{\hyperlink{namespacevt_aeafd31f866aeb4dc6fc2f6ee97136350}{vt::theMsg}}()-\/>\mbox{\hyperlink{group__preregister_ga0162a39473e7f9b490a79a7983d949ac}{sendMsg}}<recurHandler>(next\_node, msg\_send);}
\DoxyCodeLine{    \}}
\DoxyCodeLine{  \}}
\DoxyCodeLine{\}}
\end{DoxyCodeInclude}
\hypertarget{examples}{}\doxysection{Examples}\label{examples}
Small example programs to learn {\bfseries{{\itshape vt}}}

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Example  }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Description  }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Link   }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Example  }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Description  }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Link   }\\\cline{1-3}
\endhead
Jacobi1D  &1-\/D Jacobi linear system solver with homogeneous Dirichlet condition  &\mbox{\hyperlink{jacobi1d-example}{Example Jacobi 1D Program}}   \\\cline{1-3}
Jacobi2D  &2-\/D Jacobi linear system solver with homogeneous Dirichlet condition  &\mbox{\hyperlink{jacobi2d-example}{Example Jacobi 2D Program}}   \\\cline{1-3}
Reduce\+Integral  &Composite trapezoidal rule for the integral {\ttfamily \textbackslash{}int\+\_\+\{0\}$^\wedge$\{1\} f(x) dx}  &\mbox{\hyperlink{reduce-integral-example}{Example Integral Reduction Program}}   \\\cline{1-3}
\end{longtabu}
\hypertarget{jacobi1d-example}{}\doxysubsection{Example Jacobi 1D Program}\label{jacobi1d-example}
The full code for this example can be found here\+: {\ttfamily examples/collection/jacobi1d\+\_\+vt.\+cc}.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//}}
\DoxyCodeLine{\textcolor{comment}{// This code applies a few steps of the Jacobi iteration to}}
\DoxyCodeLine{\textcolor{comment}{// the linear system  A x = 0}}
\DoxyCodeLine{\textcolor{comment}{// where A is a tridiagonal matrix with pattern [-\/1 2 -\/1]}}
\DoxyCodeLine{\textcolor{comment}{// The initial guess for x is a made-\/up non-\/zero vector.}}
\DoxyCodeLine{\textcolor{comment}{// The exact solution is the vector 0.}}
\DoxyCodeLine{\textcolor{comment}{//}}
\DoxyCodeLine{\textcolor{comment}{// The matrix A is square and invertible.}}
\DoxyCodeLine{\textcolor{comment}{// The number of rows is ((number of objects) * (number of rows per object))}}
\DoxyCodeLine{\textcolor{comment}{//}}
\DoxyCodeLine{\textcolor{comment}{// Such a matrix A is obtained when using 2nd-\/order finite difference}}
\DoxyCodeLine{\textcolor{comment}{// for discretizing (-\/d\string^2 u /dx\string^2 = f) on [0, 1] with homogeneous}}
\DoxyCodeLine{\textcolor{comment}{// Dirichlet condition (u(0) = u(1) = 0) using a uniform grid}}
\DoxyCodeLine{\textcolor{comment}{// with grid size 1 / ((number of objects) * (number of rows per object) + 1)}}
\DoxyCodeLine{\textcolor{comment}{//}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <\mbox{\hyperlink{transport_8h}{vt/transport.h}}>}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <cstdlib>}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{static} constexpr std::size\_t \textcolor{keyword}{const} default\_nrow\_object = 8;}
\DoxyCodeLine{\textcolor{keyword}{static} constexpr std::size\_t \textcolor{keyword}{const} default\_num\_objs = 4;}
\DoxyCodeLine{\textcolor{keyword}{static} constexpr \textcolor{keywordtype}{double} \textcolor{keyword}{const} default\_tol = 1.0e-\/02;}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{struct }NodeObj \{}
\DoxyCodeLine{  \textcolor{keywordtype}{bool} is\_finished\_ = \textcolor{keyword}{false};}
\DoxyCodeLine{  \textcolor{keywordtype}{void} workFinishedHandler() \{ is\_finished\_ = \textcolor{keyword}{true}; \}}
\DoxyCodeLine{  \textcolor{keywordtype}{bool} isWorkFinished() \{ \textcolor{keywordflow}{return} is\_finished\_; \}}
\DoxyCodeLine{\};}
\DoxyCodeLine{\textcolor{keyword}{using} NodeObjProxy = \mbox{\hyperlink{structvt_1_1objgroup_1_1proxy_1_1_proxy}{vt::objgroup::proxy::Proxy<NodeObj>}};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{struct }LinearPb1DJacobi : \mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_collection}{vt::Collection}}<LinearPb1DJacobi,vt::Index1D> \{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{private}:}
\DoxyCodeLine{}
\DoxyCodeLine{  std::vector<double> tcur\_, told\_;}
\DoxyCodeLine{  std::vector<double> rhs\_;}
\DoxyCodeLine{  \textcolor{keywordtype}{size\_t} iter\_ = 0;}
\DoxyCodeLine{  \textcolor{keywordtype}{size\_t} msgReceived\_ = 0, totalReceive\_ = 0;}
\DoxyCodeLine{  \textcolor{keywordtype}{size\_t} numObjs\_ = 1;}
\DoxyCodeLine{  \textcolor{keywordtype}{size\_t} numRowsPerObject\_ = 1;}
\DoxyCodeLine{  \textcolor{keywordtype}{size\_t} maxIter\_ = 8;}
\DoxyCodeLine{  NodeObjProxy objProxy\_;}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{public}:}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keyword}{explicit} LinearPb1DJacobi() :}
\DoxyCodeLine{    tcur\_(), told\_(), rhs\_(), iter\_(0),}
\DoxyCodeLine{    msgReceived\_(0), totalReceive\_(0),}
\DoxyCodeLine{    numObjs\_(1), numRowsPerObject\_(1), maxIter\_(8)}
\DoxyCodeLine{  \{ \}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keyword}{using} BlankMsg = \mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_collection_message}{vt::CollectionMessage<LinearPb1DJacobi>}};}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keyword}{struct }LPMsg : \mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_collection_message}{vt::CollectionMessage}}<LinearPb1DJacobi> \{}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordtype}{size\_t} numObjects = 0;}
\DoxyCodeLine{    \textcolor{keywordtype}{size\_t} nRowPerObject = 0;}
\DoxyCodeLine{    \textcolor{keywordtype}{size\_t} iterMax = 0;}
\DoxyCodeLine{    NodeObjProxy objProxy;}
\DoxyCodeLine{}
\DoxyCodeLine{    LPMsg() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{}
\DoxyCodeLine{    LPMsg(\textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} nobjs, \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} nrow, \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} itMax, NodeObjProxy proxy) :}
\DoxyCodeLine{      numObjects(nobjs), nRowPerObject(nrow), iterMax(itMax), objProxy(proxy)}
\DoxyCodeLine{    \{ \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \};}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{void} checkCompleteCB(\textcolor{keywordtype}{double} normRes) \{}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{comment}{// Only one object for the reduction will visit}}
\DoxyCodeLine{    \textcolor{comment}{// this function}}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keyword}{auto} \textcolor{keyword}{const} iter\_max\_reached = iter\_ > maxIter\_;}
\DoxyCodeLine{    \textcolor{keyword}{auto} \textcolor{keyword}{const} norm\_res\_done = normRes < default\_tol;}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (iter\_max\_reached or norm\_res\_done) \{}
\DoxyCodeLine{      \textcolor{keyword}{auto} \textcolor{keyword}{const} to\_print = iter\_max\_reached ?}
\DoxyCodeLine{        \textcolor{stringliteral}{"\(\backslash\)n Maximum Number of Iterations Reached. \(\backslash\)n\(\backslash\)n"} :}
\DoxyCodeLine{        fmt::format(\textcolor{stringliteral}{"\(\backslash\)n Max-\/Norm Residual Reduced by \{\} \(\backslash\)n\(\backslash\)n"}, default\_tol);}
\DoxyCodeLine{}
\DoxyCodeLine{      fmt::print(to\_print);}
\DoxyCodeLine{}
\DoxyCodeLine{      \textcolor{comment}{// Notify all nodes that computation is finished}}
\DoxyCodeLine{      objProxy\_.broadcast<\&NodeObj::workFinishedHandler>();}
\DoxyCodeLine{    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{      fmt::print(\textcolor{stringliteral}{" \#\# ITER \{\} >> Residual Norm = \{\} \(\backslash\)n"}, iter\_, normRes);}
\DoxyCodeLine{    \}}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{void} doIteration() \{}
\DoxyCodeLine{}
\DoxyCodeLine{    iter\_ += 1;}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{comment}{//-\/-\/-\/ Copy extremal values}}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    tcur\_[0] = told\_[0];}
\DoxyCodeLine{    tcur\_[numRowsPerObject\_+1] = told\_[numRowsPerObject\_+1];}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{comment}{//-\/-\/-\/-\/ Jacobi iteration step}}
\DoxyCodeLine{    \textcolor{comment}{//-\/-\/-\/-\/ A tridiagonal matrix = "tridiag" ( [-\/1.0  2.0  -\/1.0] )}}
\DoxyCodeLine{    \textcolor{comment}{//-\/-\/-\/-\/ rhs\_ right hand side vector}}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} ii = 1; ii <= numRowsPerObject\_; ++ii) \{}
\DoxyCodeLine{      tcur\_[ii] = 0.5*(rhs\_[ii] + told\_[ii-\/1] + told\_[ii+1]);}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    std::copy(tcur\_.begin(), tcur\_.end(), told\_.begin());}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{comment}{// Compute the maximum entries among the rows on this object}}
\DoxyCodeLine{    \textcolor{comment}{// We do not take into account the "ghost" entries}}
\DoxyCodeLine{    \textcolor{comment}{// as they may be "out of date".}}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordtype}{double} maxNorm = 0.0;}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} ii = 1; ii < tcur\_.size()-\/1; ++ii) \{}
\DoxyCodeLine{      \textcolor{keywordtype}{double} val = tcur\_[ii];}
\DoxyCodeLine{      maxNorm = (maxNorm > std::fabs(val)) ? maxNorm : std::fabs(val);}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keyword}{auto} proxy = this-\/>\mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_collection_base_ad97d9ab1a28fb535c5d7f82c15e99791}{getCollectionProxy}}();}
\DoxyCodeLine{    proxy.\mbox{\hyperlink{structvt_1_1objgroup_1_1proxy_1_1_proxy_a10836524197347f63d5507f08d871e4f}{reduce}}<\&LinearPb1DJacobi::checkCompleteCB, \mbox{\hyperlink{structvt_1_1collective_1_1reduce_1_1operators_1_1_max_op}{vt::collective::MaxOp}}>(}
\DoxyCodeLine{      proxy[0], maxNorm}
\DoxyCodeLine{    );}
\DoxyCodeLine{}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keyword}{struct }VecMsg : \mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_collection_message}{vt::CollectionMessage}}<LinearPb1DJacobi> \{}
\DoxyCodeLine{    \textcolor{keyword}{using} MessageParentType = \mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_collection_message}{vt::CollectionMessage<LinearPb1DJacobi>}};}
\DoxyCodeLine{    \mbox{\hyperlink{message__serialize_8h_a3452798707ea3a45f9da58f7b4673990}{vt\_msg\_serialize\_if\_needed\_by\_parent\_or\_type1}}(\mbox{\hyperlink{namespacevt_afb96657e28fa98eb685c5e0c6b1b122e}{vt::IdxBase}});}
\DoxyCodeLine{}
\DoxyCodeLine{    VecMsg() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{}
\DoxyCodeLine{    VecMsg(\mbox{\hyperlink{namespacevt_afb96657e28fa98eb685c5e0c6b1b122e}{vt::IdxBase}} \textcolor{keyword}{const}\& in\_index, \textcolor{keywordtype}{double} \textcolor{keyword}{const}\& ref) :}
\DoxyCodeLine{      \mbox{\hyperlink{namespacevt}{vt}}::\mbox{\hyperlink{namespacevt_ae7700e12f79c0fec16964aab84838428}{CollectionMessage}}<LinearPb1DJacobi>(),}
\DoxyCodeLine{      from\_index(in\_index), val(ref)}
\DoxyCodeLine{    \{ \}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keyword}{template} <\textcolor{keyword}{typename} Serializer>}
\DoxyCodeLine{    \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacecheckpoint_a075da4e7344cf037943362517e606c3a}{serialize}}(Serializer\& s) \{}
\DoxyCodeLine{      \mbox{\hyperlink{namespacecheckpoint_a075da4e7344cf037943362517e606c3a}{MessageParentType::serialize}}(s);}
\DoxyCodeLine{      s | from\_index;}
\DoxyCodeLine{      s | val;}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    \mbox{\hyperlink{namespacevt_afb96657e28fa98eb685c5e0c6b1b122e}{vt::IdxBase}} from\_index = 0;}
\DoxyCodeLine{    \textcolor{keywordtype}{double} val = 0.0;}
\DoxyCodeLine{  \};}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{void} exchange(VecMsg *msg) \{}
\DoxyCodeLine{    \textcolor{comment}{// Receive and treat the message from a neighboring object.}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keyword}{const} \mbox{\hyperlink{namespacevt_afb96657e28fa98eb685c5e0c6b1b122e}{vt::IdxBase}} myIdx = \mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_indexable_a28d05f23e7a20e12e94b8235305c1e82}{getIndex}}().x();}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (myIdx > msg-\/>from\_index) \{}
\DoxyCodeLine{      this-\/>told\_[0] = msg-\/>val;}
\DoxyCodeLine{      msgReceived\_ += 1;}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (myIdx < msg-\/>from\_index) \{}
\DoxyCodeLine{      this-\/>told\_[numRowsPerObject\_ + 1] = msg-\/>val;}
\DoxyCodeLine{      msgReceived\_ += 1;}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{// Check whether this 'object' has received all the expected messages.}}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (msgReceived\_ == totalReceive\_) \{}
\DoxyCodeLine{      msgReceived\_ = 0;}
\DoxyCodeLine{      doIteration();}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{void} doIter([[maybe\_unused]] BlankMsg *msg) \{}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{comment}{// Treat the particular case of 1 object}}
\DoxyCodeLine{    \textcolor{comment}{// where no communication is needed.}}
\DoxyCodeLine{    \textcolor{comment}{// Without this treatment, the code would not iterate.}}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (numObjs\_ == 1) \{}
\DoxyCodeLine{      doIteration();}
\DoxyCodeLine{      \textcolor{keywordflow}{return};}
\DoxyCodeLine{    \}}
\DoxyCodeLine{    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{comment}{// Routine to send information to a different object}}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{}
\DoxyCodeLine{    \mbox{\hyperlink{namespacevt_afb96657e28fa98eb685c5e0c6b1b122e}{vt::IdxBase}} \textcolor{keyword}{const} myIdx = \mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_indexable_a28d05f23e7a20e12e94b8235305c1e82}{getIndex}}().x();}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{//-\/-\/-\/ Send the values to the left}}
\DoxyCodeLine{    \textcolor{keyword}{auto} proxy = this-\/>\mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_collection_base_ad97d9ab1a28fb535c5d7f82c15e99791}{getCollectionProxy}}();}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (myIdx > 0) \{}
\DoxyCodeLine{      proxy[myIdx -\/ 1].send<VecMsg, \&LinearPb1DJacobi::exchange>(}
\DoxyCodeLine{        myIdx, told\_[1]}
\DoxyCodeLine{      );}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{//-\/-\/-\/ Send values to the right}}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (\textcolor{keywordtype}{size\_t}(myIdx) < numObjs\_ -\/ 1) \{}
\DoxyCodeLine{      proxy[myIdx + 1].send<VecMsg, \&LinearPb1DJacobi::exchange>(}
\DoxyCodeLine{        myIdx, told\_[numRowsPerObject\_]}
\DoxyCodeLine{      );}
\DoxyCodeLine{    \}}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{void} init() \{}
\DoxyCodeLine{}
\DoxyCodeLine{    tcur\_.assign(numRowsPerObject\_ + 2, 0.0);}
\DoxyCodeLine{    told\_.assign(numRowsPerObject\_ + 2, 0.0);}
\DoxyCodeLine{    rhs\_.assign(numRowsPerObject\_ + 2, 0.0);}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordtype}{double} h = 1.0 / (numRowsPerObject\_ * numObjs\_ + 1.0);}
\DoxyCodeLine{    \textcolor{keywordtype}{int} nf = 3 * int(numRowsPerObject\_ * numObjs\_ + 1) / 4;}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordtype}{size\_t} \textcolor{keyword}{const} myIdx = \mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_indexable_a28d05f23e7a20e12e94b8235305c1e82}{getIndex}}().x();}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} ii = 0; ii < tcur\_.size(); ++ii) \{}
\DoxyCodeLine{      \textcolor{keywordtype}{double} x0 = ( numRowsPerObject\_ * myIdx + ii) * h;}
\DoxyCodeLine{      tcur\_[ii] = sin(nf * M\_PI * x0 * x0);}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    totalReceive\_ = 2;}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (myIdx == 0) \{}
\DoxyCodeLine{      tcur\_[0] = 0.0;}
\DoxyCodeLine{      totalReceive\_ -\/= 1;}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (myIdx == numObjs\_ -\/ 1) \{}
\DoxyCodeLine{      tcur\_[numRowsPerObject\_+1] = 0.0;}
\DoxyCodeLine{      totalReceive\_ -\/= 1;}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    std::copy(tcur\_.begin(), tcur\_.end(), told\_.begin());}
\DoxyCodeLine{}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{void} init(LPMsg* msg) \{}
\DoxyCodeLine{    numObjs\_ = msg-\/>numObjects;}
\DoxyCodeLine{    numRowsPerObject\_ = msg-\/>nRowPerObject;}
\DoxyCodeLine{    maxIter\_ = msg-\/>iterMax;}
\DoxyCodeLine{    objProxy\_ = msg-\/>objProxy;}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{// Initialize the starting vector}}
\DoxyCodeLine{    init();}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{bool} isWorkDone( \mbox{\hyperlink{structvt_1_1objgroup_1_1proxy_1_1_proxy}{vt::objgroup::proxy::Proxy<NodeObj>}} \textcolor{keyword}{const}\& proxy)\{}
\DoxyCodeLine{  \textcolor{keyword}{auto} \textcolor{keyword}{const} this\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{  \textcolor{keywordflow}{return} proxy[this\_node].invoke<\&NodeObj::isWorkFinished>();}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{int} main(\textcolor{keywordtype}{int} argc, \textcolor{keywordtype}{char}** argv) \{}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{size\_t} num\_objs = default\_num\_objs;}
\DoxyCodeLine{  \textcolor{keywordtype}{size\_t} numRowsPerObject = default\_nrow\_object;}
\DoxyCodeLine{  \textcolor{keywordtype}{size\_t} maxIter = 8;}
\DoxyCodeLine{}
\DoxyCodeLine{  std::string name(argv[0]);}
\DoxyCodeLine{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a580ef23e9a224fc0907da1a6db308b5b}{vt::initialize}}(argc, argv);}
\DoxyCodeLine{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{vt::NodeType}} this\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{vt::NodeType}} num\_nodes = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a7f41071aadf6d5fa9e1b6c703c5ff19d}{getNumNodes}}();}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordflow}{if} (argc == 1) \{}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (this\_node == 0) \{}
\DoxyCodeLine{      fmt::print(}
\DoxyCodeLine{        stderr, \textcolor{stringliteral}{"\{\}: using default arguments since none provided\(\backslash\)n"}, name}
\DoxyCodeLine{      );}
\DoxyCodeLine{    \}}
\DoxyCodeLine{    num\_objs = default\_num\_objs * num\_nodes;}
\DoxyCodeLine{  \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (argc == 2) \{}
\DoxyCodeLine{    num\_objs = static\_cast<size\_t>(strtol(argv[1], \textcolor{keyword}{nullptr}, 10));}
\DoxyCodeLine{  \}}
\DoxyCodeLine{  \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (argc == 3) \{}
\DoxyCodeLine{    num\_objs = static\_cast<size\_t>(strtol(argv[1], \textcolor{keyword}{nullptr}, 10));}
\DoxyCodeLine{    numRowsPerObject = static\_cast<size\_t>(strtol(argv[2], \textcolor{keyword}{nullptr}, 10));}
\DoxyCodeLine{  \}}
\DoxyCodeLine{  \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (argc == 4) \{}
\DoxyCodeLine{    num\_objs = static\_cast<size\_t>(strtol(argv[1], \textcolor{keyword}{nullptr}, 10));}
\DoxyCodeLine{    numRowsPerObject = static\_cast<size\_t>(strtol(argv[2], \textcolor{keyword}{nullptr}, 10));}
\DoxyCodeLine{    maxIter = static\_cast<size\_t>(strtol(argv[3], \textcolor{keyword}{nullptr}, 10));}
\DoxyCodeLine{  \}}
\DoxyCodeLine{  \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{    fmt::print(}
\DoxyCodeLine{      stderr, \textcolor{stringliteral}{"usage: \{\} <num-\/objects> <num-\/rows-\/per-\/object> <maxiter>\(\backslash\)n"},}
\DoxyCodeLine{      name}
\DoxyCodeLine{    );}
\DoxyCodeLine{    \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Object group of all nodes that take part in computation}}
\DoxyCodeLine{  \textcolor{comment}{// Used to determine whether the computation is finished}}
\DoxyCodeLine{  \textcolor{keyword}{auto} grp\_proxy = \mbox{\hyperlink{namespacevt_a833f0115b692f578167cbd88e30d39c5}{vt::theObjGroup}}()-\/>\mbox{\hyperlink{structvt_1_1objgroup_1_1_obj_group_manager_a50e0d8498d142a05773ed5a046803b2b}{makeCollective}}<NodeObj>(\textcolor{stringliteral}{"examples\_jacobi1d"});}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Create the decomposition into objects}}
\DoxyCodeLine{  \textcolor{keyword}{using} BaseIndexType = \textcolor{keyword}{typename} \mbox{\hyperlink{structvt_1_1index_1_1_dense_index_array_a36698427e28045290d1fb072573275ec}{vt::Index1D::DenseIndexType}};}
\DoxyCodeLine{  \textcolor{keyword}{auto} range = \mbox{\hyperlink{namespacevt_a5540efc78234273e1796fb003fe4d234}{vt::Index1D}}(static\_cast<BaseIndexType>(num\_objs));}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keyword}{auto} col\_proxy = vt::makeCollection<LinearPb1DJacobi>(\textcolor{stringliteral}{"examples\_jacobi1d"})}
\DoxyCodeLine{    .bounds(range)}
\DoxyCodeLine{    .bulkInsert()}
\DoxyCodeLine{    .wait();}
\DoxyCodeLine{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a2fc4ef34f30b49a1781d765804bfadbb}{vt::runInEpochCollective}}([col\_proxy, grp\_proxy, num\_objs, numRowsPerObject, maxIter]\{}
\DoxyCodeLine{    col\_proxy.broadcastCollective<LinearPb1DJacobi::LPMsg, \&LinearPb1DJacobi::init>(}
\DoxyCodeLine{      num\_objs, numRowsPerObject, maxIter, grp\_proxy}
\DoxyCodeLine{    );}
\DoxyCodeLine{  \});}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordflow}{while}(!isWorkDone(grp\_proxy))\{}
\DoxyCodeLine{    \mbox{\hyperlink{namespacevt_a2fc4ef34f30b49a1781d765804bfadbb}{vt::runInEpochCollective}}([col\_proxy]\{}
\DoxyCodeLine{      col\_proxy.broadcastCollective<}
\DoxyCodeLine{        LinearPb1DJacobi::BlankMsg, \&LinearPb1DJacobi::doIter}
\DoxyCodeLine{      >();}
\DoxyCodeLine{    \});}
\DoxyCodeLine{}
\DoxyCodeLine{    \mbox{\hyperlink{namespacevt_a3799d6b51fb71d7b6505760aad457e61}{vt::thePhase}}()-\/>\mbox{\hyperlink{structvt_1_1phase_1_1_phase_manager_ac94bfde4a103cbdec426542191c41092}{nextPhaseCollective}}();}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a540d90dbd6e97b69f1dcbc9ee9314cff}{vt::finalize}}();}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\end{DoxyCodeInclude}
\hypertarget{jacobi2d-example}{}\doxysubsection{Example Jacobi 2D Program}\label{jacobi2d-example}
The full code for this example can be found here\+: {\ttfamily examples/collection/jacobi2d\+\_\+vt.\+cc}.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//}}
\DoxyCodeLine{\textcolor{comment}{// This code applies a few steps of the Jacobi iteration to}}
\DoxyCodeLine{\textcolor{comment}{// the linear system  A x = 0}}
\DoxyCodeLine{\textcolor{comment}{// where A is a banded symmetric positive definite matrix.}}
\DoxyCodeLine{\textcolor{comment}{// The initial guess for x is a made-\/up non-\/zero vector.}}
\DoxyCodeLine{\textcolor{comment}{// The exact solution is the vector 0.}}
\DoxyCodeLine{\textcolor{comment}{//}}
\DoxyCodeLine{\textcolor{comment}{// The matrix A is square and invertible.}}
\DoxyCodeLine{\textcolor{comment}{// The number of rows is ((number of objects) * (number of rows per object))}}
\DoxyCodeLine{\textcolor{comment}{//}}
\DoxyCodeLine{\textcolor{comment}{// Such a matrix A is obtained when using 2nd-\/order finite difference}}
\DoxyCodeLine{\textcolor{comment}{// for discretizing}}
\DoxyCodeLine{\textcolor{comment}{//}}
\DoxyCodeLine{\textcolor{comment}{// -\/d\string^2 u / dx\string^2 -\/d\string^2 u / dy\string^2 = f   on  [0, 1] x [0, 1]}}
\DoxyCodeLine{\textcolor{comment}{//}}
\DoxyCodeLine{\textcolor{comment}{// with homogeneous Dirichlet condition}}
\DoxyCodeLine{\textcolor{comment}{//}}
\DoxyCodeLine{\textcolor{comment}{// u = 0 on the boundary of [0, 1] x [0, 1]}}
\DoxyCodeLine{\textcolor{comment}{//}}
\DoxyCodeLine{\textcolor{comment}{// using a uniform grid with grid size}}
\DoxyCodeLine{\textcolor{comment}{//}}
\DoxyCodeLine{\textcolor{comment}{// 1 / ((number of objects) * (number of rows per object) + 1)}}
\DoxyCodeLine{\textcolor{comment}{//}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{static} constexpr std::size\_t \textcolor{keyword}{const} default\_nrow\_object = 8;}
\DoxyCodeLine{\textcolor{keyword}{static} constexpr std::size\_t \textcolor{keyword}{const} default\_num\_objs = 4;}
\DoxyCodeLine{\textcolor{keyword}{static} constexpr \textcolor{keywordtype}{double} \textcolor{keyword}{const} default\_tol = 1.0e-\/02;}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{struct }NodeObj \{}
\DoxyCodeLine{  \textcolor{keywordtype}{bool} is\_finished\_ = \textcolor{keyword}{false};}
\DoxyCodeLine{  \textcolor{keywordtype}{void} workFinishedHandler() \{ is\_finished\_ = \textcolor{keyword}{true}; \}}
\DoxyCodeLine{  \textcolor{keywordtype}{bool} isWorkFinished() \{ \textcolor{keywordflow}{return} is\_finished\_; \}}
\DoxyCodeLine{\};}
\DoxyCodeLine{\textcolor{keyword}{using} NodeObjProxy = \mbox{\hyperlink{structvt_1_1objgroup_1_1proxy_1_1_proxy}{vt::objgroup::proxy::Proxy<NodeObj>}};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{struct }LinearPb2DJacobi : \mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_collection}{vt::Collection}}<LinearPb2DJacobi,vt::Index2D> \{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{private}:}
\DoxyCodeLine{}
\DoxyCodeLine{  std::vector<double> tcur\_, told\_;}
\DoxyCodeLine{  std::vector<double> rhs\_;}
\DoxyCodeLine{  \textcolor{keywordtype}{size\_t} iter\_ = 0;}
\DoxyCodeLine{  \textcolor{keywordtype}{size\_t} msgReceived\_ = 0, totalReceive\_ = 0;}
\DoxyCodeLine{  \textcolor{keywordtype}{size\_t} numObjsX\_ = 1, numObjsY\_ = 1;}
\DoxyCodeLine{  \textcolor{keywordtype}{size\_t} numRowsPerObject\_ = default\_nrow\_object;}
\DoxyCodeLine{  \textcolor{keywordtype}{size\_t} maxIter\_ = 5;}
\DoxyCodeLine{  NodeObjProxy objProxy\_;}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{public}:}
\DoxyCodeLine{}
\DoxyCodeLine{  LinearPb2DJacobi()}
\DoxyCodeLine{    : tcur\_(), told\_(), rhs\_(), iter\_(0),}
\DoxyCodeLine{      msgReceived\_(0), totalReceive\_(0),}
\DoxyCodeLine{      numObjsX\_(1), numObjsY\_(1),}
\DoxyCodeLine{      numRowsPerObject\_(default\_nrow\_object),}
\DoxyCodeLine{      maxIter\_(5)}
\DoxyCodeLine{  \{ \}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keyword}{struct }BlankMsg : \mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_collection_message}{vt::CollectionMessage}}<LinearPb2DJacobi> \{ \};}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keyword}{struct }LPMsg : \mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_collection_message}{vt::CollectionMessage}}<LinearPb2DJacobi> \{}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordtype}{size\_t} numXObjs = 0;}
\DoxyCodeLine{    \textcolor{keywordtype}{size\_t} numYObjs = 0;}
\DoxyCodeLine{    \textcolor{keywordtype}{size\_t} numIter = 0;}
\DoxyCodeLine{    NodeObjProxy objProxy;}
\DoxyCodeLine{}
\DoxyCodeLine{    LPMsg() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{}
\DoxyCodeLine{    LPMsg(\textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} nx, \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} ny, \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} nref, NodeObjProxy proxy)}
\DoxyCodeLine{      : numXObjs(nx), numYObjs(ny), numIter(nref), objProxy(proxy)}
\DoxyCodeLine{    \{ \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \};}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{void} checkCompleteCB(\textcolor{keywordtype}{double} \textcolor{keyword}{const} normRes) \{}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{comment}{// Only one object for the reduction will visit}}
\DoxyCodeLine{    \textcolor{comment}{// this function}}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keyword}{auto} \textcolor{keyword}{const} iter\_max\_reached = iter\_ > maxIter\_;}
\DoxyCodeLine{    \textcolor{keyword}{auto} \textcolor{keyword}{const} norm\_res\_done = normRes < default\_tol;}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (iter\_max\_reached or norm\_res\_done) \{}
\DoxyCodeLine{      \textcolor{keyword}{auto} \textcolor{keyword}{const} to\_print = iter\_max\_reached ?}
\DoxyCodeLine{        \textcolor{stringliteral}{"\(\backslash\)n Maximum Number of Iterations Reached. \(\backslash\)n\(\backslash\)n"} :}
\DoxyCodeLine{        fmt::format(\textcolor{stringliteral}{"\(\backslash\)n Max-\/Norm Residual Reduced by \{\} \(\backslash\)n\(\backslash\)n"}, default\_tol);}
\DoxyCodeLine{}
\DoxyCodeLine{      fmt::print(to\_print);}
\DoxyCodeLine{}
\DoxyCodeLine{      \textcolor{comment}{// Notify all nodes that computation is finished}}
\DoxyCodeLine{      objProxy\_.broadcast<\&NodeObj::workFinishedHandler>();}
\DoxyCodeLine{    \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{      fmt::print(\textcolor{stringliteral}{" \#\# ITER \{\} >> Residual Norm = \{\} \(\backslash\)n"}, iter\_, normRes);}
\DoxyCodeLine{    \}}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{void} doIteration() \{}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{comment}{//-\/-\/-\/ Copy ghost values}}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordtype}{size\_t} ldx = numRowsPerObject\_ + 2;}
\DoxyCodeLine{    \textcolor{keywordtype}{size\_t} ldy = numRowsPerObject\_ + 2;}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} jx = 0; jx < ldx; ++jx)}
\DoxyCodeLine{      tcur\_[jx] = told\_[jx];}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} jx = 0; jx < ldx; ++jx)}
\DoxyCodeLine{      tcur\_[jx + (ldy-\/1) * ldx] = told\_[jx + (ldy-\/1) * ldx];}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} jy = 0; jy < ldy; ++jy)}
\DoxyCodeLine{      tcur\_[jy * ldx] = told\_[jy * ldx];}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} jy = 0; jy < ldy; ++jy)}
\DoxyCodeLine{      tcur\_[ldx-\/1 + jy * ldx] = told\_[ldx-\/1 + jy * ldx];}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{comment}{//-\/-\/-\/ Update my row values}}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} iy = 1; iy <= numRowsPerObject\_; ++iy) \{}
\DoxyCodeLine{      \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} ix = 1; ix <= numRowsPerObject\_; ++ix) \{}
\DoxyCodeLine{        \textcolor{comment}{//}}
\DoxyCodeLine{        \textcolor{comment}{//-\/-\/-\/-\/ Jacobi iteration step for}}
\DoxyCodeLine{        \textcolor{comment}{//-\/-\/-\/-\/ A banded matrix for the 5-\/point stencil}}
\DoxyCodeLine{        \textcolor{comment}{//-\/-\/-\/-\/ [ 0.0  -\/1.0   0.0]}}
\DoxyCodeLine{        \textcolor{comment}{//-\/-\/-\/-\/ [-\/1.0   4.0  -\/1.0]}}
\DoxyCodeLine{        \textcolor{comment}{//-\/-\/-\/-\/ [ 0.0  -\/1.0   0.0]}}
\DoxyCodeLine{        \textcolor{comment}{//-\/-\/-\/-\/ rhs\_ right hand side vector}}
\DoxyCodeLine{        \textcolor{comment}{//}}
\DoxyCodeLine{        \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{namespacevt_1_1config_a46e57c33bee1b9f1fa95455af86d80e0a576033c81e2ddd03d721ecef3b1b3f81}{node}} = ix + iy * ldx;}
\DoxyCodeLine{        tcur\_[\mbox{\hyperlink{namespacevt_1_1config_a46e57c33bee1b9f1fa95455af86d80e0a576033c81e2ddd03d721ecef3b1b3f81}{node}}] = 0.25 * (rhs\_[\mbox{\hyperlink{namespacevt_1_1config_a46e57c33bee1b9f1fa95455af86d80e0a576033c81e2ddd03d721ecef3b1b3f81}{node}}]}
\DoxyCodeLine{                              + told\_[\mbox{\hyperlink{namespacevt_1_1config_a46e57c33bee1b9f1fa95455af86d80e0a576033c81e2ddd03d721ecef3b1b3f81}{node}} -\/ 1] + told\_[\mbox{\hyperlink{namespacevt_1_1config_a46e57c33bee1b9f1fa95455af86d80e0a576033c81e2ddd03d721ecef3b1b3f81}{node}} + 1]}
\DoxyCodeLine{                              + told\_[\mbox{\hyperlink{namespacevt_1_1config_a46e57c33bee1b9f1fa95455af86d80e0a576033c81e2ddd03d721ecef3b1b3f81}{node}} -\/ ldx] + told\_[\mbox{\hyperlink{namespacevt_1_1config_a46e57c33bee1b9f1fa95455af86d80e0a576033c81e2ddd03d721ecef3b1b3f81}{node}} + ldx]);}
\DoxyCodeLine{      \}}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    iter\_ += 1;}
\DoxyCodeLine{}
\DoxyCodeLine{    std::copy(tcur\_.begin(), tcur\_.end(), told\_.begin());}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{comment}{// Compute the maximum entries among the rows on this object}}
\DoxyCodeLine{    \textcolor{comment}{// We do not take into account the "ghost" entries}}
\DoxyCodeLine{    \textcolor{comment}{// as they may be "out of date".}}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordtype}{double} maxNorm = 0.0;}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} iy = 1; iy <= numRowsPerObject\_; ++iy) \{}
\DoxyCodeLine{      \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} ix = 1; ix <= numRowsPerObject\_; ++ix) \{}
\DoxyCodeLine{        \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{namespacevt_1_1config_a46e57c33bee1b9f1fa95455af86d80e0a576033c81e2ddd03d721ecef3b1b3f81}{node}} = ix + iy * ldx;}
\DoxyCodeLine{        \textcolor{keywordtype}{double} val = tcur\_[\mbox{\hyperlink{namespacevt_1_1config_a46e57c33bee1b9f1fa95455af86d80e0a576033c81e2ddd03d721ecef3b1b3f81}{node}}];}
\DoxyCodeLine{        maxNorm = (maxNorm > std::fabs(val)) ? maxNorm : std::fabs(val);}
\DoxyCodeLine{      \}}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keyword}{auto} proxy = this-\/>\mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_collection_base_ad97d9ab1a28fb535c5d7f82c15e99791}{getCollectionProxy}}();}
\DoxyCodeLine{    proxy.\mbox{\hyperlink{structvt_1_1objgroup_1_1proxy_1_1_proxy_a10836524197347f63d5507f08d871e4f}{reduce}}<\&LinearPb2DJacobi::checkCompleteCB, \mbox{\hyperlink{structvt_1_1collective_1_1reduce_1_1operators_1_1_max_op}{vt::collective::MaxOp}}>(}
\DoxyCodeLine{      proxy(0,0), maxNorm}
\DoxyCodeLine{    );}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keyword}{struct }VecMsg : \mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_collection_message}{vt::CollectionMessage}}<LinearPb2DJacobi> \{}
\DoxyCodeLine{    \textcolor{keyword}{using} MessageParentType = \mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_collection_message}{vt::CollectionMessage<LinearPb2DJacobi>}};}
\DoxyCodeLine{    \mbox{\hyperlink{message__serialize_8h_a54128d5338aaa9c918179826085e13d1}{vt\_msg\_serialize\_required}}(); \textcolor{comment}{// stl vector}}
\DoxyCodeLine{}
\DoxyCodeLine{    VecMsg() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{    VecMsg(IndexType \textcolor{keyword}{const}\& in\_index, \textcolor{keyword}{const} std::vector<double> \&ref) :}
\DoxyCodeLine{      \mbox{\hyperlink{namespacevt}{vt}}::\mbox{\hyperlink{namespacevt_ae7700e12f79c0fec16964aab84838428}{CollectionMessage}}<LinearPb2DJacobi>(),}
\DoxyCodeLine{      from\_index(in\_index), val(ref)}
\DoxyCodeLine{    \{ \}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keyword}{template} <\textcolor{keyword}{typename} Serializer>}
\DoxyCodeLine{    \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacecheckpoint_a075da4e7344cf037943362517e606c3a}{serialize}}(Serializer\& s) \{}
\DoxyCodeLine{      \mbox{\hyperlink{namespacecheckpoint_a075da4e7344cf037943362517e606c3a}{MessageParentType::serialize}}(s);}
\DoxyCodeLine{      s | from\_index;}
\DoxyCodeLine{      s | val;}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    IndexType from\_index;}
\DoxyCodeLine{    std::vector<double> val;}
\DoxyCodeLine{  \};}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{void} exchange(VecMsg *msg) \{}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{// Receive and treat the message from a neighboring object.}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (this-\/>\mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_indexable_a28d05f23e7a20e12e94b8235305c1e82}{getIndex}}().x() > msg-\/>from\_index.x()) \{}
\DoxyCodeLine{      \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} ldx = numRowsPerObject\_ + 2;}
\DoxyCodeLine{      \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} jy = 0; jy < msg-\/>val.size(); ++jy) \{}
\DoxyCodeLine{        this-\/>told\_[jy*ldx] = msg-\/>val[jy];}
\DoxyCodeLine{      \}}
\DoxyCodeLine{      msgReceived\_ += 1;}
\DoxyCodeLine{    \}}
\DoxyCodeLine{    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (this-\/>\mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_indexable_a28d05f23e7a20e12e94b8235305c1e82}{getIndex}}().x() < msg-\/>from\_index.x()) \{}
\DoxyCodeLine{      \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} ldx = numRowsPerObject\_ + 2;}
\DoxyCodeLine{      \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} jy = 0; jy < msg-\/>val.size(); ++jy) \{}
\DoxyCodeLine{        this-\/>told\_[numRowsPerObject\_ + 1 + jy*ldx] = msg-\/>val[jy];}
\DoxyCodeLine{      \}}
\DoxyCodeLine{      msgReceived\_ += 1;}
\DoxyCodeLine{    \}}
\DoxyCodeLine{    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (this-\/>\mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_indexable_a28d05f23e7a20e12e94b8235305c1e82}{getIndex}}().y() > msg-\/>from\_index.y()) \{}
\DoxyCodeLine{      std::copy(msg-\/>val.begin(), msg-\/>val.end(), this-\/>told\_.begin());}
\DoxyCodeLine{      msgReceived\_ += 1;}
\DoxyCodeLine{    \}}
\DoxyCodeLine{    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (this-\/>\mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_indexable_a28d05f23e7a20e12e94b8235305c1e82}{getIndex}}().y() < msg-\/>from\_index.y()) \{}
\DoxyCodeLine{      std::copy(msg-\/>val.begin(), msg-\/>val.end(),}
\DoxyCodeLine{                \&this-\/>told\_[(numRowsPerObject\_ + 1)*(numRowsPerObject\_ + 2)]);}
\DoxyCodeLine{      msgReceived\_ += 1;}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (msgReceived\_ == totalReceive\_) \{}
\DoxyCodeLine{      msgReceived\_ = 0;}
\DoxyCodeLine{      doIteration();}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{void} doIter([[maybe\_unused]] BlankMsg *msg) \{}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{comment}{// Treat the particular case of 1 object}}
\DoxyCodeLine{    \textcolor{comment}{// where no communication is needed.}}
\DoxyCodeLine{    \textcolor{comment}{// Without this treatment, the code would not iterate.}}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (numObjsX\_*numObjsY\_ <= 1) \{}
\DoxyCodeLine{      doIteration();}
\DoxyCodeLine{      \textcolor{keywordflow}{return};}
\DoxyCodeLine{    \}}
\DoxyCodeLine{    \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{comment}{// Routine to send information to a neighboring object}}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keyword}{auto} proxy = this-\/>\mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_collection_base_ad97d9ab1a28fb535c5d7f82c15e99791}{getCollectionProxy}}();}
\DoxyCodeLine{    \textcolor{keyword}{auto} idx = this-\/>\mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_indexable_a28d05f23e7a20e12e94b8235305c1e82}{getIndex}}();}
\DoxyCodeLine{    \textcolor{keyword}{auto} \textcolor{keyword}{const} x = idx.x();}
\DoxyCodeLine{    \textcolor{keyword}{auto} \textcolor{keyword}{const} y = idx.y();}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (x > 0) \{}
\DoxyCodeLine{      std::vector<double> tcopy(numRowsPerObject\_ + 2, 0.0);}
\DoxyCodeLine{      \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} jy = 1; jy <= numRowsPerObject\_; ++jy)}
\DoxyCodeLine{        tcopy[jy] = told\_[1 + jy * (numRowsPerObject\_ + 2)];}
\DoxyCodeLine{      proxy(x-\/1, y).send<VecMsg, \&LinearPb2DJacobi::exchange>(idx, tcopy);}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (y > 0) \{}
\DoxyCodeLine{      std::vector<double> tcopy(numRowsPerObject\_ + 2, 0.0);}
\DoxyCodeLine{      \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} jx = 1; jx <= numRowsPerObject\_; ++jx)}
\DoxyCodeLine{        tcopy[jx] = told\_[jx + (numRowsPerObject\_ + 2)];}
\DoxyCodeLine{      proxy(x, y-\/1).send<VecMsg, \&LinearPb2DJacobi::exchange>(idx, tcopy);}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (\textcolor{keywordtype}{size\_t}(x) < numObjsX\_ -\/ 1) \{}
\DoxyCodeLine{      std::vector<double> tcopy(numRowsPerObject\_ + 2, 0.0);}
\DoxyCodeLine{      \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} jy = 1; jy <= numRowsPerObject\_; ++jy) \{}
\DoxyCodeLine{        tcopy[jy] = told\_[numRowsPerObject\_ +}
\DoxyCodeLine{                          jy * (numRowsPerObject\_ + 2)];}
\DoxyCodeLine{      \}}
\DoxyCodeLine{      proxy(x+1, y).send<VecMsg, \&LinearPb2DJacobi::exchange>(idx, tcopy);}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (\textcolor{keywordtype}{size\_t}(y) < numObjsY\_ -\/ 1) \{}
\DoxyCodeLine{      std::vector<double> tcopy(numRowsPerObject\_ + 2, 0.0);}
\DoxyCodeLine{      \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} jx = 1; jx <= numRowsPerObject\_; ++jx)}
\DoxyCodeLine{        tcopy[jx] = told\_[jx + numRowsPerObject\_ * (numRowsPerObject\_ + 2)];}
\DoxyCodeLine{      proxy(x, y+1).send<VecMsg, \&LinearPb2DJacobi::exchange>(idx, tcopy);}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{void} init() \{}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{//-\/-\/-\/ Each object will work with (numRowsPerObject\_ + 2) unknowns}}
\DoxyCodeLine{    \textcolor{comment}{//-\/-\/-\/ or (numRowsPerObject\_ + 2) rows of the matrix}}
\DoxyCodeLine{    \textcolor{keywordtype}{size\_t} ldx = numRowsPerObject\_ + 2, ldy = ldx;}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordtype}{size\_t} vecSize = ldx * ldy;}
\DoxyCodeLine{    tcur\_.assign(vecSize, 0.0);}
\DoxyCodeLine{    told\_.assign(vecSize, 0.0);}
\DoxyCodeLine{    rhs\_.assign(vecSize, 0.0);}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{comment}{// Set the initial vector to the values of}}
\DoxyCodeLine{    \textcolor{comment}{// a "high-\/frequency" function}}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordtype}{double} hx = 1.0 / (numRowsPerObject\_ * numObjsX\_ + 1.0);}
\DoxyCodeLine{    \textcolor{keywordtype}{double} hy = 1.0 / (numRowsPerObject\_ * numObjsY\_ + 1.0);}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordtype}{size\_t} maxNObjs = (size\_t) std::max(numObjsX\_, numObjsY\_);}
\DoxyCodeLine{    \textcolor{keywordtype}{int} nf = 3 * int(numRowsPerObject\_ * maxNObjs + 1) / 4;}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keyword}{auto} idx = this-\/>\mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_indexable_a28d05f23e7a20e12e94b8235305c1e82}{getIndex}}();}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} iy = 0; iy < ldy; ++iy) \{}
\DoxyCodeLine{      \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} ix = 0; ix < ldx; ++ix) \{}
\DoxyCodeLine{        \textcolor{keywordtype}{double} x0 = ( numRowsPerObject\_ * idx.x() + ix) * hx;}
\DoxyCodeLine{        \textcolor{keywordtype}{double} y0 = ( numRowsPerObject\_ * idx.y() + iy) * hy;}
\DoxyCodeLine{        \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{namespacevt_1_1config_a46e57c33bee1b9f1fa95455af86d80e0a576033c81e2ddd03d721ecef3b1b3f81}{node}} = ix + iy * ldx;}
\DoxyCodeLine{        tcur\_[\mbox{\hyperlink{namespacevt_1_1config_a46e57c33bee1b9f1fa95455af86d80e0a576033c81e2ddd03d721ecef3b1b3f81}{node}}] = sin(nf * M\_PI * (x0 * x0 + y0 * y0));}
\DoxyCodeLine{      \}}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    totalReceive\_ = 4;}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{comment}{//-\/-\/-\/ The unknowns correspond to the interior nodes}}
\DoxyCodeLine{    \textcolor{comment}{//-\/-\/-\/ of a regular orthogonal grid on [0, 1] x [0, 1]}}
\DoxyCodeLine{    \textcolor{comment}{//-\/-\/-\/ The total number of grid points in X-\/direction is}}
\DoxyCodeLine{    \textcolor{comment}{//-\/-\/-\/ (numRowsPerObject\_ * numObjsX\_) + 2}}
\DoxyCodeLine{    \textcolor{comment}{//-\/-\/-\/ The total number of grid points in Y-\/direction is}}
\DoxyCodeLine{    \textcolor{comment}{//-\/-\/-\/ (numRowsPerObject\_ * numObjsY\_) + 2}}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (idx.x() == 0) \{}
\DoxyCodeLine{      \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} jy = 0; jy < ldy; ++jy)}
\DoxyCodeLine{        tcur\_[jy * ldy] = 0.0;}
\DoxyCodeLine{      totalReceive\_ -\/= 1;}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (idx.y() == 0) \{}
\DoxyCodeLine{      \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} jx = 0; jx < ldx; ++jx)}
\DoxyCodeLine{        tcur\_[jx] = 0.0;}
\DoxyCodeLine{      totalReceive\_ -\/= 1;}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (numObjsX\_ == \textcolor{keywordtype}{size\_t}(idx.x()) + 1) \{}
\DoxyCodeLine{      \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} jy = 0; jy < ldy; ++jy)}
\DoxyCodeLine{        tcur\_[jy * ldy + (ldx -\/ 1)] = 0.0;}
\DoxyCodeLine{      totalReceive\_ -\/= 1;}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (numObjsY\_ == \textcolor{keywordtype}{size\_t}(idx.y()) + 1) \{}
\DoxyCodeLine{      \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} jx = 0; jx < ldx; ++jx)}
\DoxyCodeLine{        tcur\_[jx + (ldx -\/ 1)*ldy] = 0.0;}
\DoxyCodeLine{      totalReceive\_ -\/= 1;}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    std::copy(tcur\_.begin(), tcur\_.end(), told\_.begin());}
\DoxyCodeLine{}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{void} init(LPMsg* msg) \{}
\DoxyCodeLine{}
\DoxyCodeLine{    numObjsX\_ = msg-\/>numXObjs;}
\DoxyCodeLine{    numObjsY\_ = msg-\/>numYObjs;}
\DoxyCodeLine{    maxIter\_ = msg-\/>numIter;}
\DoxyCodeLine{    objProxy\_ = msg-\/>objProxy;}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{// Initialize the starting vector}}
\DoxyCodeLine{    init();}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{bool} isWorkDone( \mbox{\hyperlink{structvt_1_1objgroup_1_1proxy_1_1_proxy}{vt::objgroup::proxy::Proxy<NodeObj>}} \textcolor{keyword}{const}\& proxy)\{}
\DoxyCodeLine{  \textcolor{keyword}{auto} \textcolor{keyword}{const} this\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{  \textcolor{keywordflow}{return} proxy[this\_node].invoke<\&NodeObj::isWorkFinished>();}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{int} main(\textcolor{keywordtype}{int} argc, \textcolor{keywordtype}{char}** argv) \{}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{size\_t} numX\_objs = default\_num\_objs;}
\DoxyCodeLine{  \textcolor{keywordtype}{size\_t} numY\_objs = default\_num\_objs;}
\DoxyCodeLine{  \textcolor{keywordtype}{size\_t} maxIter = 10;}
\DoxyCodeLine{}
\DoxyCodeLine{  std::string name(argv[0]);}
\DoxyCodeLine{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a580ef23e9a224fc0907da1a6db308b5b}{vt::initialize}}(argc, argv);}
\DoxyCodeLine{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{vt::NodeType}} this\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordflow}{if} (argc == 1) \{}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (this\_node == 0) \{}
\DoxyCodeLine{      fmt::print(}
\DoxyCodeLine{        stderr, \textcolor{stringliteral}{"\{\}: using default arguments since none provided\(\backslash\)n"}, name}
\DoxyCodeLine{      );}
\DoxyCodeLine{    \}}
\DoxyCodeLine{  \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (argc == 3) \{}
\DoxyCodeLine{      numX\_objs = (size\_t) strtol(argv[1], \textcolor{keyword}{nullptr}, 10);}
\DoxyCodeLine{      numY\_objs = (size\_t) strtol(argv[2], \textcolor{keyword}{nullptr}, 10);}
\DoxyCodeLine{    \}}
\DoxyCodeLine{    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (argc == 4) \{}
\DoxyCodeLine{      numX\_objs = (size\_t) strtol(argv[1], \textcolor{keyword}{nullptr}, 10);}
\DoxyCodeLine{      numY\_objs = (size\_t) strtol(argv[2], \textcolor{keyword}{nullptr}, 10);}
\DoxyCodeLine{      maxIter = (size\_t) strtol(argv[3], \textcolor{keyword}{nullptr}, 10);}
\DoxyCodeLine{    \}}
\DoxyCodeLine{    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{      fmt::print(}
\DoxyCodeLine{        stderr, \textcolor{stringliteral}{"usage: \{\} <num-\/objects-\/X-\/direction> <num-\/objects-\/Y-\/direction> <maxiter>\(\backslash\)n"},}
\DoxyCodeLine{        name}
\DoxyCodeLine{      );}
\DoxyCodeLine{      \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{    \}}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{/* -\/-\/-\/ Print information about the simulation */}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordflow}{if} (this\_node == 0) \{}
\DoxyCodeLine{    fmt::print(}
\DoxyCodeLine{      stdout, \textcolor{stringliteral}{"\(\backslash\)n -\/ Solve the linear system for the Laplacian with homogeneous Dirichlet"}}
\DoxyCodeLine{      \textcolor{stringliteral}{" on [0, 1] x [0, 1]\(\backslash\)n"}}
\DoxyCodeLine{    );}
\DoxyCodeLine{    fmt::print(stdout, \textcolor{stringliteral}{" -\/ Second-\/order centered finite difference\(\backslash\)n"});}
\DoxyCodeLine{    fmt::print(}
\DoxyCodeLine{      stdout, \textcolor{stringliteral}{" -\/ Uniform grid with (\{\} x \{\} = \{\}) points in the x-\/direction and "}}
\DoxyCodeLine{      \textcolor{stringliteral}{" (\{\} x \{\} = \{\}) points in the y-\/direction\(\backslash\)n"},}
\DoxyCodeLine{      numX\_objs, default\_nrow\_object, numX\_objs * default\_nrow\_object,}
\DoxyCodeLine{      numY\_objs, default\_nrow\_object, numY\_objs * default\_nrow\_object}
\DoxyCodeLine{    );}
\DoxyCodeLine{    fmt::print(stdout, \textcolor{stringliteral}{" -\/ Maximum number of iterations \{\}\(\backslash\)n"}, maxIter);}
\DoxyCodeLine{    fmt::print(stdout, \textcolor{stringliteral}{" -\/ Convergence tolerance \{\}\(\backslash\)n"}, default\_tol);}
\DoxyCodeLine{    fmt::print(stdout, \textcolor{stringliteral}{"\(\backslash\)n"});}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Object group of all nodes that take part in computation}}
\DoxyCodeLine{  \textcolor{comment}{// Used to determine whether the computation is finished}}
\DoxyCodeLine{  \textcolor{keyword}{auto} grp\_proxy = \mbox{\hyperlink{namespacevt_a833f0115b692f578167cbd88e30d39c5}{vt::theObjGroup}}()-\/>\mbox{\hyperlink{structvt_1_1objgroup_1_1_obj_group_manager_a50e0d8498d142a05773ed5a046803b2b}{makeCollective}}<NodeObj>(\textcolor{stringliteral}{"examples\_jacobi2d"});}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Create the decomposition into objects}}
\DoxyCodeLine{  \textcolor{keyword}{using} BaseIndexType = \textcolor{keyword}{typename} \mbox{\hyperlink{structvt_1_1index_1_1_dense_index_array_a36698427e28045290d1fb072573275ec}{vt::Index2D::DenseIndexType}};}
\DoxyCodeLine{  \textcolor{keyword}{auto} range = \mbox{\hyperlink{namespacevt_a3bab786053b74a3d856fff1412ffa73a}{vt::Index2D}}(}
\DoxyCodeLine{    static\_cast<BaseIndexType>(numX\_objs),}
\DoxyCodeLine{    static\_cast<BaseIndexType>(numY\_objs)}
\DoxyCodeLine{  );}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keyword}{auto} col\_proxy = vt::makeCollection<LinearPb2DJacobi>(\textcolor{stringliteral}{"examples\_jacobi2d"})}
\DoxyCodeLine{    .bounds(range)}
\DoxyCodeLine{    .bulkInsert()}
\DoxyCodeLine{    .wait();}
\DoxyCodeLine{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a2fc4ef34f30b49a1781d765804bfadbb}{vt::runInEpochCollective}}([col\_proxy, grp\_proxy, numX\_objs, numY\_objs, maxIter] \{}
\DoxyCodeLine{    col\_proxy.broadcastCollective<LinearPb2DJacobi::LPMsg, \&LinearPb2DJacobi::init>(}
\DoxyCodeLine{      numX\_objs, numY\_objs, maxIter, grp\_proxy}
\DoxyCodeLine{    );}
\DoxyCodeLine{  \});}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordflow}{while} (!isWorkDone(grp\_proxy)) \{}
\DoxyCodeLine{    \mbox{\hyperlink{namespacevt_a2fc4ef34f30b49a1781d765804bfadbb}{vt::runInEpochCollective}}([col\_proxy] \{}
\DoxyCodeLine{      col\_proxy.broadcastCollective<}
\DoxyCodeLine{        LinearPb2DJacobi::BlankMsg, \&LinearPb2DJacobi::doIter>();}
\DoxyCodeLine{    \});}
\DoxyCodeLine{}
\DoxyCodeLine{    \mbox{\hyperlink{namespacevt_a3799d6b51fb71d7b6505760aad457e61}{vt::thePhase}}()-\/>\mbox{\hyperlink{structvt_1_1phase_1_1_phase_manager_ac94bfde4a103cbdec426542191c41092}{nextPhaseCollective}}();}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a540d90dbd6e97b69f1dcbc9ee9314cff}{vt::finalize}}();}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{}
\DoxyCodeLine{\}}
\end{DoxyCodeInclude}
\hypertarget{reduce-integral-example}{}\doxysubsection{Example Integral Reduction Program}\label{reduce-integral-example}
The full code for this example can be found here\+: {\ttfamily examples/collection/reduce\+\_\+integral.\+cc}.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//}}
\DoxyCodeLine{\textcolor{comment}{// This code computes a composite trapezoidal rule for the integral}}
\DoxyCodeLine{\textcolor{comment}{// \(\backslash\)int\_\{0\}\string^\{1\} f(x) dx}}
\DoxyCodeLine{\textcolor{comment}{//}}
\DoxyCodeLine{\textcolor{comment}{// The function 'f' is defined in the code.}}
\DoxyCodeLine{\textcolor{comment}{//}}
\DoxyCodeLine{\textcolor{comment}{// The interval [0, 1] is broken into uniform sub-\/intervals of length}}
\DoxyCodeLine{\textcolor{comment}{//}}
\DoxyCodeLine{\textcolor{comment}{// H = 1.0 / (\# of objects)}}
\DoxyCodeLine{\textcolor{comment}{//}}
\DoxyCodeLine{\textcolor{comment}{// Each sub-\/interval [xi, xi + H] is broken into smaller parts of length}}
\DoxyCodeLine{\textcolor{comment}{//}}
\DoxyCodeLine{\textcolor{comment}{// h = H / (\# of parts per object)}}
\DoxyCodeLine{\textcolor{comment}{//}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <\mbox{\hyperlink{transport_8h}{vt/transport.h}}>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <cmath>}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{static} constexpr std::size\_t \textcolor{keyword}{const} default\_nparts\_object = 8;}
\DoxyCodeLine{\textcolor{keyword}{static} constexpr std::size\_t \textcolor{keyword}{const} default\_num\_objs = 4;}
\DoxyCodeLine{\textcolor{keyword}{static} constexpr std::size\_t \textcolor{keyword}{const} \mbox{\hyperlink{namespacevt_1_1config_a724e99568632cc0fe9c456c2230270d0a9b54bf70f7b7fe7cfb6f3da0e167ae27}{verbose}} = 1;}
\DoxyCodeLine{\textcolor{keyword}{static} constexpr \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{vt::NodeType}} \textcolor{keyword}{const} reduce\_root\_node = 0;}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keywordtype}{bool} root\_reduce\_finished = \textcolor{keyword}{false};}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keywordtype}{double} exactIntegral = 0.0;}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//}}
\DoxyCodeLine{\textcolor{comment}{// Function 'f' to integrate over [0, 1]}}
\DoxyCodeLine{\textcolor{comment}{//}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{double} f(\textcolor{keywordtype}{double} x) \{}
\DoxyCodeLine{  \textcolor{comment}{//-\/-\/-\/-\/}}
\DoxyCodeLine{  \textcolor{comment}{//exactIntegral = 1.0 / 3.0;}}
\DoxyCodeLine{  \textcolor{comment}{//return x*x;}}
\DoxyCodeLine{  \textcolor{comment}{//-\/-\/-\/-\/}}
\DoxyCodeLine{  exactIntegral = M\_2\_PI;}
\DoxyCodeLine{  \textcolor{keywordflow}{return} sin(M\_PI * x);}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{using} \mbox{\hyperlink{namespacevt_1_1collective_a4c5bf7769ad4396573d6bcc85ec430a4}{ReduceMsg}} = \mbox{\hyperlink{structvt_1_1collective_1_1reduce_1_1operators_1_1_reduce_data_msg}{vt::collective::ReduceTMsg<double>}};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{struct }Integration1D : \mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_collection}{vt::Collection}}<Integration1D, vt::Index1D> \{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{private}:}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{size\_t} numObjs\_ = default\_num\_objs;}
\DoxyCodeLine{  \textcolor{keywordtype}{size\_t} numPartsPerObject\_ = default\_nparts\_object;}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{public}:}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keyword}{explicit} Integration1D()}
\DoxyCodeLine{    : numObjs\_(default\_num\_objs),}
\DoxyCodeLine{      numPartsPerObject\_(default\_nparts\_object)}
\DoxyCodeLine{  \{ \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{void} checkIntegral(\textcolor{keywordtype}{double} val) \{}
\DoxyCodeLine{    fmt::print(\textcolor{stringliteral}{" >> The integral over [0, 1] is \{\}\(\backslash\)n"}, val);}
\DoxyCodeLine{    fmt::print(}
\DoxyCodeLine{      \textcolor{stringliteral}{" >> The absolute error is \{\}\(\backslash\)n"},}
\DoxyCodeLine{      std::fabs(val -\/ exactIntegral)}
\DoxyCodeLine{    );}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{comment}{// Set the 'root\_reduce\_finished' variable to true.}}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    root\_reduce\_finished = \textcolor{keyword}{true};}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keyword}{struct }InitMsg : \mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_collection_message}{vt::CollectionMessage}}<Integration1D> \{}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordtype}{size\_t} numObjects = 0;}
\DoxyCodeLine{    \textcolor{keywordtype}{size\_t} nIntervalPerObject = 0;}
\DoxyCodeLine{}
\DoxyCodeLine{    InitMsg(\textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} nobjs, \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} nint)}
\DoxyCodeLine{      : numObjects(nobjs), nIntervalPerObject(nint)}
\DoxyCodeLine{    \{ \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \};}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{void} compute(InitMsg *msg) \{}
\DoxyCodeLine{}
\DoxyCodeLine{    numObjs\_ = msg-\/>numObjects;}
\DoxyCodeLine{    numPartsPerObject\_ = msg-\/>nIntervalPerObject;}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{comment}{// Compute the integral with the trapezoidal rule}}
\DoxyCodeLine{    \textcolor{comment}{// over the interval [a, b]}}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{comment}{// a = numPartsPerObject\_ * (IndexID) * h}}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{comment}{// b = a + numPartsPerObject\_ * h}}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{comment}{// where h = 1.0 / (numPartsPerObject\_ * numObjs\_ )}}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{comment}{// Since 0 <= (IndexID) < numObjs\_, the union of these intervals}}
\DoxyCodeLine{    \textcolor{comment}{// covers [0, 1]}}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordtype}{double} h = 1.0 / (numPartsPerObject\_ * numObjs\_ );}
\DoxyCodeLine{    \textcolor{keywordtype}{double} quadsum = 0.0;}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordtype}{double} a = numPartsPerObject\_ * \mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_indexable_a28d05f23e7a20e12e94b8235305c1e82}{getIndex}}().x() * h;}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{comment}{// Apply composite trapezoidal rule over}}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{comment}{// [a, a + numPartsPerObject\_ * h]}}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} ii = 0; ii < numPartsPerObject\_; ++ii) \{}
\DoxyCodeLine{      \textcolor{keywordtype}{double} x0 = a + ii * h;}
\DoxyCodeLine{      \textcolor{comment}{/* -\/-\/-\/ Trapeze Quadrature Rule over the interval [x0, x0+h] */}}
\DoxyCodeLine{      quadsum += 0.5 * h * ( f(x0) + f(x0+h) );}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacevt_1_1config_a724e99568632cc0fe9c456c2230270d0a9b54bf70f7b7fe7cfb6f3da0e167ae27}{verbose}} > 0) \{}
\DoxyCodeLine{      \textcolor{keywordtype}{double} b = a + numPartsPerObject\_ * h;}
\DoxyCodeLine{      fmt::print(}
\DoxyCodeLine{        \textcolor{stringliteral}{" Interval [\{\}, \{\}], on node \{\} \& object \{\}, "}}
\DoxyCodeLine{        \textcolor{stringliteral}{"has integral \{\}.\(\backslash\)n"}, a, b, \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{vt::theContext}}()-\/>getNode(),}
\DoxyCodeLine{        \mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_indexable_a28d05f23e7a20e12e94b8235305c1e82}{getIndex}}(), quadsum}
\DoxyCodeLine{      );}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{    \textcolor{comment}{// Reduce the partial sum to get the integral over [0, 1]}}
\DoxyCodeLine{    \textcolor{comment}{//}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keyword}{auto} proxy = this-\/>\mbox{\hyperlink{structvt_1_1vrt_1_1collection_1_1_collection_base_ad97d9ab1a28fb535c5d7f82c15e99791}{getCollectionProxy}}();}
\DoxyCodeLine{    proxy.\mbox{\hyperlink{structvt_1_1objgroup_1_1proxy_1_1_proxy_a10836524197347f63d5507f08d871e4f}{reduce}}<\&Integration1D::checkIntegral, \mbox{\hyperlink{structvt_1_1collective_1_1reduce_1_1operators_1_1_plus_op}{vt::collective::PlusOp}}>(}
\DoxyCodeLine{      proxy[0], quadsum}
\DoxyCodeLine{    );}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{int} main(\textcolor{keywordtype}{int} argc, \textcolor{keywordtype}{char}** argv) \{}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{size\_t} num\_objs = default\_num\_objs;}
\DoxyCodeLine{  \textcolor{keywordtype}{size\_t} numIntPerObject = default\_nparts\_object;}
\DoxyCodeLine{}
\DoxyCodeLine{  std::string name(argv[0]);}
\DoxyCodeLine{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a580ef23e9a224fc0907da1a6db308b5b}{vt::initialize}}(argc, argv);}
\DoxyCodeLine{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{vt::NodeType}} this\_node = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}();}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a866da9d0efc19c0a1ce79e9e492f47e2}{vt::NodeType}} num\_nodes = \mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a7f41071aadf6d5fa9e1b6c703c5ff19d}{getNumNodes}}();}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordflow}{if} (argc == 1) \{}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (this\_node == 0) \{}
\DoxyCodeLine{      fmt::print(}
\DoxyCodeLine{        stderr, \textcolor{stringliteral}{"\{\}: using default arguments since none provided\(\backslash\)n"}, name}
\DoxyCodeLine{      );}
\DoxyCodeLine{    \}}
\DoxyCodeLine{    num\_objs = default\_num\_objs * num\_nodes;}
\DoxyCodeLine{  \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (argc == 2) \{}
\DoxyCodeLine{      num\_objs = (size\_t) strtol(argv[1], \textcolor{keyword}{nullptr}, 10);}
\DoxyCodeLine{    \}}
\DoxyCodeLine{    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (argc == 3) \{}
\DoxyCodeLine{      num\_objs = (size\_t) strtol(argv[1], \textcolor{keyword}{nullptr}, 10);}
\DoxyCodeLine{      numIntPerObject = (size\_t) strtol(argv[2], \textcolor{keyword}{nullptr}, 10);}
\DoxyCodeLine{    \}}
\DoxyCodeLine{    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{      fmt::print(}
\DoxyCodeLine{        stderr,}
\DoxyCodeLine{        \textcolor{stringliteral}{"usage: \{\} <num-\/objects> <num-\/interval-\/per-\/object>\(\backslash\)n"}, name}
\DoxyCodeLine{      );}
\DoxyCodeLine{      \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{    \}}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{//}}
\DoxyCodeLine{  \textcolor{comment}{// Create the interval decomposition into objects}}
\DoxyCodeLine{  \textcolor{comment}{//}}
\DoxyCodeLine{  \textcolor{keyword}{using} BaseIndexType = \textcolor{keyword}{typename} \mbox{\hyperlink{structvt_1_1index_1_1_dense_index_array_a36698427e28045290d1fb072573275ec}{vt::Index1D::DenseIndexType}};}
\DoxyCodeLine{  \textcolor{keyword}{auto} range = \mbox{\hyperlink{namespacevt_a5540efc78234273e1796fb003fe4d234}{vt::Index1D}}(static\_cast<BaseIndexType>(num\_objs));}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keyword}{auto} proxy = vt::makeCollection<Integration1D>(\textcolor{stringliteral}{"examples\_reduce\_integral"})}
\DoxyCodeLine{    .bounds(range)}
\DoxyCodeLine{    .bulkInsert()}
\DoxyCodeLine{    .wait();}
\DoxyCodeLine{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a2fc4ef34f30b49a1781d765804bfadbb}{vt::runInEpochCollective}}([proxy, num\_objs, numIntPerObject]\{}
\DoxyCodeLine{    proxy.broadcastCollective<Integration1D::InitMsg, \&Integration1D::compute>(}
\DoxyCodeLine{      num\_objs, numIntPerObject}
\DoxyCodeLine{    );}
\DoxyCodeLine{  \});}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Add something like this to validate the reduction.}}
\DoxyCodeLine{  \textcolor{comment}{// Create the variable root\_reduce\_finished as a static variable,}}
\DoxyCodeLine{  \textcolor{comment}{// which is only checked on one node.}}
\DoxyCodeLine{  \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespacevt_a26551fe0e6e6a1371111df5b12c7e92c}{vt::theContext}}()-\/>\mbox{\hyperlink{structvt_1_1ctx_1_1_context_a0d52c263ce8516546a67443d9a86fa5f}{getNode}}() == reduce\_root\_node) \{}
\DoxyCodeLine{    \mbox{\hyperlink{config__assert_8h_a60b04695e9ed43131da50386a2ced779}{vtAssertExpr}}(root\_reduce\_finished == \textcolor{keyword}{true});}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \mbox{\hyperlink{namespacevt_a540d90dbd6e97b69f1dcbc9ee9314cff}{vt::finalize}}();}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{}
\DoxyCodeLine{\}}
\end{DoxyCodeInclude}
