<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Learn &raquo; How to Build | checkpoint</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="m-dark+documentation.compiled.css" />
  <link rel="icon" href="favicon-dark.png" type="image/png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <a href="index.html" id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">checkpoint</a>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li>
              <a href="ckpt_learn.html">Learn</a>
              <ol>
                <li><a href="ckpt_learn_build.html" id="m-navbar-current">How to Build</a></li>
                <li><a href="ckpt_learn_examples.html">Examples</a></li>
                <li><a href="ckpt_learn_serialize.html">How to Serialize Data</a></li>
              </ol>
            </li>
            <li><a href="pages.html">Pages</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="3">
            <li><a href="annotated.html">Classes</a></li>
            <li><a href="files.html">Files</a></li>
            <li>
              <a href="https://github.com/">GitHub</a>
              <ol>
                <li><a href="https://github.com/DARMA-tasking/checkpoint">Checkpoint</a></li>
                <li><a href="https://github.com/DARMA-tasking/checkpoint-member-analyzer">Checkpoint Analyzer</a></li>
                <li><a href="https://github.com/DARMA-tasking/detector">Detector</a></li>
              </ol>
            </li>
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          <span class="m-breadcrumb"><a href="ckpt_learn.html">Learn</a> &raquo;</span>
          How to Build
        </h1>
<p>checkpoint can be built with <code>cmake</code>.</p><section id="ckpt_how-to-build"><h2><a href="#ckpt_how-to-build">Building</a></h2><p>To build <em>checkpoint</em>, one must obtain the following dependencies:</p><section id="ckpt_required-deps"><h3><a href="#ckpt_required-deps">Required</a></h3><ul><li><a href="https://github.com/DARMA-tasking/detector">detector</a></li></ul></section><section id="ckpt_optional-deps"><h3><a href="#ckpt_optional-deps">Optional</a></h3><ul><li>gtest, (if testing <em>checkpoint</em> is enabled)</li><li>MPI, (if MPI tests are enabled)</li><li><a href="https://github.com/kokkos/kokkos">Kokkos</a>, (if Kokkos views need to be serialized)</li><li><a href="https://github.com/kokkos/kokkos-kernels">KokkosKernels</a>, (if Kokkos kernel data structures need to be serialized)</li></ul></section><section id="ckpt_use-cmake-directly-vars"><h3><a href="#ckpt_use-cmake-directly-vars">Using cmake directly</a></h3><p>One may use <code>cmake</code> to build <em>checkpoint</em> once the dependencies are installed. The following are some options that can be provided to <code>cmake</code> to change the build configuration:</p><table class="m-table"><thead><tr><th>CMake Variable</th><th>Default Value</th><th>Description</th></tr></thead><tbody><tr><td><code>detector_DIR</code></td><td></td><td>Install directory for detector</td></tr><tr><td><code>gtest_DIR</code></td><td></td><td>Install directory for googletest</td></tr><tr><td><code>kokkos_DIR</code></td><td></td><td>Install directory for kokkos</td></tr><tr><td><code>KokkosKernels_DIR</code></td><td></td><td>Install directory for kokkoskernels</td></tr><tr><td><code>checkpoint_tests_enabled</code></td><td>0</td><td>Build <em>checkpoint</em> tests</td></tr><tr><td><code>checkpoint_mpi_enabled</code></td><td>0</td><td>Build <em>checkpoint</em> with MPI for tests</td></tr><tr><td><code>checkpoint_examples_enabled</code></td><td>0</td><td>Build <em>checkpoint</em> examples</td></tr><tr><td><code>checkpoint_warnings_as_errors</code></td><td>0</td><td>Make all warnings errors during build</td></tr><tr><td><code>checkpoint_doxygen_enabled</code></td><td>0</td><td>Enable doxygen generation</td></tr><tr><td><code>checkpoint_asan_enabled</code></td><td>0</td><td>Enable address sanitizer</td></tr><tr><td><code>CODE_COVERAGE</code></td><td>0</td><td>Generate code coverage report</td></tr></tbody></table></section><section id="using-the-build-script"><h3><a href="#using-the-build-script">Using the Build Script</a></h3><p>Instead of running <code>cmake</code>, one may invoke the <code>checkpoint/ci/build_cpp.sh</code> script which will run <code>cmake</code> for <em>checkpoint</em> with environment variables for most configuration parameters.</p><section id="building-environment-variables"><h4><a href="#building-environment-variables">Build Script Environment Variables</a></h4><table class="m-table"><thead><tr><th>Variable</th><th>Default Value</th><th>Description</th></tr></thead><tbody><tr><td><code>CMAKE_BUILD_TYPE</code></td><td>Release</td><td>The <code>cmake</code> build type</td></tr><tr><td><code>CODE_COVERAGE</code></td><td>0</td><td>Enable code coverage reporting</td></tr><tr><td><code>GTEST_ROOT</code></td><td>&lt;empty&gt;</td><td>Install directory for googletest</td></tr><tr><td><code>KOKKOS_ROOT</code></td><td>&lt;empty&gt;</td><td>Install directory for kokkos</td></tr><tr><td><code>KOKKOS_KERNELS_ROOT</code></td><td>&lt;empty&gt;</td><td>Install directory for kokkos-kernels</td></tr><tr><td><code>CHECKPOINT_DOXYGEN_ENABLED</code></td><td>0</td><td>Enable doxygen generation</td></tr><tr><td><code>CHECKPOINT_ASAN_ENABLED</code></td><td>0</td><td>Enable building with address sanitizer</td></tr><tr><td><code>CHECKPOINT_TESTS_ENABLED</code></td><td>1</td><td>Enable checkpoint tests</td></tr><tr><td><code>CHECKPOINT_EXAMPLES_ENABLED</code></td><td>1</td><td>Enable checkpoint examples</td></tr><tr><td><code>CHECKPOINT_WARNINGS_AS_ERRORS</code></td><td>0</td><td>Make all warnings errors during build</td></tr><tr><td><code>CHECKPOINT_MPI_ENABLED</code></td><td>1</td><td>Enable checkpoint MPI for testing</td></tr></tbody></table><p>With these set, invoke the script with two arguments: the path to the <em>checkpoint</em> root directory and the build path. Here&#x27;s an example assuming that <em>checkpoint</em> is cloned into <code>/usr/src/checkpoint</code> with trace enabled in debug mode.</p><p><strong>Usage for building:</strong></p><pre class="m-code">$ checkpoint/ci/build_cpp.sh &lt;full-path-to-checkpoint-source&gt; &lt;full-path-to-build-dir&gt;</pre></section></section><section id="docker-build"><h3><a href="#docker-build">Building with &lt;tt&gt;docker&lt;/tt&gt; containerization</a></h3><p>The easiest way to build <em>checkpoint</em> is by using <code>docker</code> with the available containers that contain the proper compilers, MPI, and all other dependencies. First, install <code>docker</code> on the system. On some systems, <code>docker-compose</code> might also need to be installed.</p><p>The <code>docker</code> builds are configured through <code>docker-compose</code> to use a shared, cached filesystem mount with the host for <code>ccache</code> to enable fast re-builds.</p><p>For <code>docker-compose</code>, the following variables can be set to configure the build. One may configure the architecture, compiler type (GNU, Clang, Intel, Nvidia) and compiler version, Linux distro (ubuntu or alpine), and distro version.</p><p>The default set of the docker configuration options is located in <code>checkpoint/.env</code>, which <code>docker-compose</code> will read.</p><pre class="m-code"><span class="cp"># Variables:</span>
<span class="cp">#   ARCH={amd64, arm64v8, ...}</span>
<span class="cp">#   COMPILER_TYPE={gnu, clang, intel, nvidia}</span>
<span class="cp">#   COMPILER={gcc-5, gcc-6, gcc-7, gcc-8, gcc-9, gcc-10,</span>
<span class="cp">#             clang-3.9, clang-4.0, clang-5.0, clang-6.0, clang-7, clang-8,</span>
<span class="cp">#             clang-9, clang-10,</span>
<span class="cp">#             icc-18, icc-19,</span>
<span class="cp">#             nvcc-10, nvcc-11}</span>
<span class="cp">#   REPO=lifflander1/checkpoint</span>
<span class="cp">#   UBUNTU={18.04, 20.04}</span>
<span class="cp">#   ULIMIT_CORE=0</span>
<span class="cp">#</span>
<span class="cp"># DARMA/checkpoint Configuration Variables:</span>
<span class="cp">#   CHECKPOINT_TESTS=1               # Enable checkpoint tests</span>
<span class="cp">#   CHECKPOINT_EXAMPLES=1            # Enable checkpoint examples</span>
<span class="cp">#   CHECKPOINT_MPI=1                 # Enable checkpoint MPI tests</span>
<span class="cp">#   CHECKPOINT_WARNINGS_AS_ERRORS=0  # Treat warnings as errors in compilation</span>
<span class="cp">#   CHECKPOINT_ASAN=0                # Enable address sanitizer in build</span>
<span class="cp">#   CHECKPOINT_DOCS=0                # Enable doxygen build</span>
<span class="cp">#   BUILD_TYPE=release               # CMake build type</span>
<span class="cp">#   CODE_COVERAGE=0                  # Enable generation of code coverage reports</span></pre><p>With these set, one may run the following for a non-interactive build with ubuntu. Or, to speed up the build process, the base container can be pulled for many of the common configurations: <code>docker-compose pull ubuntu-cpp</code>.</p><pre class="m-code">$ <span class="nb">cd</span> checkpoint
$ docker-compose run -e <span class="nv">BUILD_TYPE</span><span class="o">=</span>debug ubuntu-cpp</pre><p>For an interactive build with ubuntu, where one can build, debug, and run <code>valgrind</code>, etc:</p><pre class="m-code">$ <span class="nb">cd</span> checkpoint
$ docker-compose run -e <span class="nv">BUILD_TYPE</span><span class="o">=</span>debug ubuntu-cpp-interactive
<span class="c1"># /checkpoint/ci/build_cpp.sh /checkpoint /build</span>
<span class="c1"># /checkpoint/ci/test_cpp.sh /checkpoint /build</span></pre></section></section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form>
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or
            modules. You can omit any prefix from the symbol or file path; adding a
            <code>:</code> or <code>/</code> suffix lists all members of given symbol or
            directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span>
            / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v1.js"></script>
<script src="searchdata-v1.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>checkpoint. Created with <a href="https://doxygen.org/">Doxygen</a> 1.8.17 and <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>
